<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset="utf-8">
    
    <title>The Old Man and the Sea</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="All any predator can do is to keep on trying.">
<meta property="og:type" content="website">
<meta property="og:title" content="The Old Man and the Sea">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="The Old Man and the Sea">
<meta property="og:description" content="All any predator can do is to keep on trying.">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="The Old Man and the Sea">
<meta name="twitter:description" content="All any predator can do is to keep on trying.">
    

    
        <link rel="alternate" href="/" title="The Old Man and the Sea" type="application/atom+xml" />
    

    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/open-sans/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/2.1.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
    
    


</head>

<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                <i class="logo"></i>
                <span class="site-title">The Old Man and the Sea</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/.">Home</a>
                
                    <a class="main-nav-link" href="/archives">Archives</a>
                
                    <a class="main-nav-link" href="/categories">Categories</a>
                
                    <a class="main-nav-link" href="/tags">Tags</a>
                
                    <a class="main-nav-link" href="https://ernestchang.github.io/2017/08/23/other/about/">About</a>
                
            </nav>
            
                
                <nav id="sub-nav">
                    <div class="profile" id="profile-nav">
                        <a id="profile-anchor" href="javascript:;">
                            <img class="avatar" src="/uploads/images/avert.png" />
                            <i class="fa fa-caret-down"></i>
                        </a>
                    </div>
                </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/.">Home</a></td>
                
                    <td><a class="main-nav-link" href="/archives">Archives</a></td>
                
                    <td><a class="main-nav-link" href="/categories">Categories</a></td>
                
                    <td><a class="main-nav-link" href="/tags">Tags</a></td>
                
                    <td><a class="main-nav-link" href="https://ernestchang.github.io/2017/08/23/other/about/">About</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
                

<aside id="profile">
    <div class="inner profile-inner">
        <div class="base-info profile-block">
            <img id="avatar" src="/uploads/images/avert.png" />
            <h2 id="name">Ernest Chang</h2>
            <h3 id="title">Developer &amp; Designer</h3>
            <span id="location"><i class="fa fa-map-marker"></i>Hangzhou, China</span>
            <a id="follow" target="_blank" href="https://github.com/Ernestchang/">FOLLOW</a>
        </div>
        <div class="article-info profile-block">
            <div class="article-info-block">
                52
                <span>posts</span>
            </div>
            <div class="article-info-block">
                15
                <span>tags</span>
            </div>
        </div>
        
        <div class="profile-block social-links">
            <table>
                <tr>
                    
                    
                    <td>
                        <a href="https://github.com/Ernestchang/" target="_blank" title="github" class=tooltip>
                            <i class="fa fa-github"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="twitter" class=tooltip>
                            <i class="fa fa-twitter"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="facebook" class=tooltip>
                            <i class="fa fa-facebook"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="dribbble" class=tooltip>
                            <i class="fa fa-dribbble"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="rss" class=tooltip>
                            <i class="fa fa-rss"></i>
                        </a>
                    </td>
                    
                </tr>
            </table>
        </div>
        
    </div>
</aside>

            
            <section id="main">
    <article id="post-android/books/《Android 编程实战》Chap4_手势操作进阶, 重识Service" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/09/11/android/books/《Android 编程实战》Chap4_手势操作进阶, 重识Service/">《Android 编程实战》Chap4_手势操作进阶, 重识Service</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/09/11/android/books/《Android 编程实战》Chap4_手势操作进阶, 重识Service/">
            <time datetime="2017-09-11T13:36:48.000Z" itemprop="datePublished">2017-09-11</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/android/">android</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/android/《Android-编程实战》/">《Android 编程实战》</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/android/">android</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <blockquote>
<p>阅读《Android 编程实战》一书的随记笔记<br>注：本文主要参考<a href="http://szysky.com" target="_blank" rel="external">http://szysky.com</a></p>
</blockquote>
<h2 id="设计自定义视图"><a href="#设计自定义视图" class="headerlink" title="设计自定义视图"></a>设计自定义视图</h2><h3 id="View的声明周期"><a href="#View的声明周期" class="headerlink" title="View的声明周期"></a>View的声明周期</h3><p><code>View</code>也有自己的声明周期. 该生命周期并不直接和展示它的<code>Fragment</code>或者<code>Activity</code>相连, 相反<strong>它和显示它的窗口状态以及渲染循环相关</strong></p>
<p>当视图被添加到View层级结构中时, 第一个被回调的函数是<code>View.onAttachedToWindow()</code>, 这标志着它现在可以加载所需的资源了. 构建自定义视图时, 开发者应该重载该方法, 并在该方法中加载所有资源并初始化视图所需的依赖. 基本上所有的耗时的初始化都应该放在这个方法内.</p>
<p>还要一个匹配的回调名为<code>View.onDetachedFromWindow()</code>, 从View层次结构中移除视图时调用这个方法. 在这里需要关注的是需要显示清理的操作, 比如所有被加载的资源, 启动的<code>Service</code>, 或者其他依赖.</p>
<p>视图被添加到<code>View</code>层次结构中之后, 它会经过一个循环, 该循环首先计算动画, 接下来会一次回调<code>View.onMeasure()</code>, <code>View.onLayout()</code>, <code>View.onDraw()</code>等方法.</p>
<h3 id="多点触控"><a href="#多点触控" class="headerlink" title="多点触控"></a>多点触控</h3><p>先看下图效果:</p>
<p><img src="http://szysky.com/2016/09/26/%E3%80%8AAndroid-%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98%E3%80%8B04-%E7%95%8C%E9%9D%A2%E6%93%8D%E4%BD%9C-Service/multi1.gif" alt="img"></p>
<p>贴一下实现的主要代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div></pre></td><td class="code"><pre><div class="line">@Override</div><div class="line">protected void onDraw(final Canvas canvas) &#123;</div><div class="line">   super.onDraw(canvas);</div><div class="line"></div><div class="line">   // 绘制已经完成过的手势事件的所有path路径</div><div class="line">   // 如果不循环绘制, 那么当一个触控点到达了up事件之后, 那么这个触控点从down到up的事件的轨迹将会消失.</div><div class="line">   for (Path completedPath : mCompletedPaths) &#123;</div><div class="line">       canvas.drawPath(completedPath, mFingerPaint);</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   // 绘制当前触摸屏上的触摸事件正在进行的轨迹 (down ~ up)</div><div class="line">   for (Path fingerPath : mFingerPaths) &#123;</div><div class="line">       if (fingerPath != null)&#123;</div><div class="line">           canvas.drawPath(fingerPath, mFingerPaint);</div><div class="line">       &#125;</div><div class="line">   &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@Override</div><div class="line">public boolean onTouchEvent(MotionEvent event) &#123;</div><div class="line">   // 获得当前触摸屏上的触摸个数</div><div class="line">   int pointerCount = event.getPointerCount();</div><div class="line">   int cappedPointerCount = pointerCount &gt; MAX_FINGERS ? MAX_FINGERS : pointerCount;</div><div class="line"></div><div class="line">   // 获得当前触摸事件对象所在系统保存队列中的位置</div><div class="line">   int actionIndex = event.getActionIndex();</div><div class="line">   // 获得当前触摸事件的动作类型,  这里包括 MotionEvent.ACTION_POINTER_DOWN, MotionEvent.ACTION_POINTER_UP 多点触控按下和多点触控抬起(对应数值5, 6)</div><div class="line">   int action = event.getActionMasked();</div><div class="line">   // 此值返回此触摸事件存在时刻的唯一标识id.</div><div class="line">   int pointerId = event.getPointerId(actionIndex);</div><div class="line"></div><div class="line"></div><div class="line">   // 检查是否收到按下或者抬起的动作</div><div class="line">   if ((action == MotionEvent.ACTION_DOWN || action == MotionEvent.ACTION_POINTER_DOWN) &amp;&amp; pointerId &lt; MAX_FINGERS )&#123;</div><div class="line">  </div><div class="line">       // 当有新的触摸事件开始的时候, 就使用这个事件的标识id来当下标创建一个Path对象存储起来</div><div class="line">       mFingerPaths[pointerId] = new Path();</div><div class="line">       // 注意虽然在down事件中, actionIndex和pointerId会保持一致, 但最好使用触摸事件所在的队列位置来获取坐标</div><div class="line">       mFingerPaths[pointerId].moveTo(event.getX(actionIndex), event.getY(actionIndex));</div><div class="line">  </div><div class="line"></div><div class="line">   &#125;else if ((action == MotionEvent.ACTION_UP || action == MotionEvent.ACTION_POINTER_UP) &amp;&amp; pointerId &lt; MAX_FINGERS)&#123;</div><div class="line">       // 这里的pointerId和actionIndex不一定保持一致!! 所以一定要正确使用这个两个来获取</div><div class="line">       mFingerPaths[pointerId].setLastPoint(event.getX(actionIndex), event.getY(actionIndex));</div><div class="line">       mCompletedPaths.add(mFingerPaths[pointerId]);</div><div class="line"></div><div class="line">       mFingerPaths[pointerId].computeBounds(mPathBounds, true);</div><div class="line">       invalidate((int) mPathBounds.left, (int) mPathBounds.top, (int) mPathBounds.right, (int) mPathBounds.bottom);</div><div class="line">       mFingerPaths[pointerId] = null;</div><div class="line"></div><div class="line">   &#125;</div><div class="line"></div><div class="line">   int tempIndex = 0;</div><div class="line">   // 这里主要是move事件时候进行的动态绘制实现</div><div class="line">   for (int i = 0; i &lt; cappedPointerCount; i++) &#123;</div><div class="line">       // 保证滑动事件不丢失</div><div class="line">       while(mFingerPaths[tempIndex] == null)&#123;</div><div class="line">           tempIndex++;</div><div class="line">           if (tempIndex &gt; 4)&#123;</div><div class="line">               return true;</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line">       if (mFingerPaths[tempIndex] != null)&#123;</div><div class="line">           // 通过数组的下标也就是触摸事件的唯一标识id获得队列中的位置</div><div class="line">           int index = event.findPointerIndex(tempIndex);</div><div class="line">           // 对从down事件或者上一次移动事件的Path进行lineTo移动.</div><div class="line">           mFingerPaths[tempIndex].lineTo(event.getX(index), event.getY(index));</div><div class="line">           mFingerPaths[tempIndex].computeBounds(mPathBounds, true);</div><div class="line">           invalidate((int) mPathBounds.left, (int) mPathBounds.top, (int) mPathBounds.right, (int) mPathBounds.bottom);</div><div class="line">           tempIndex++;</div><div class="line">       &#125;</div><div class="line"></div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>以上是伪代码, 如果想需要完整类,<a href="https://github.com/suzeyu1992/AndroidProgrammingPushingTheLimits/blob/master/MultiTouch/app/src/main/java/com/szysky/note/multitouch/MultiTouchView.java" target="_blank" rel="external">点击此链接到github查看</a></p>
<p>这里在进行解释说明一下:</p>
<p>每次时间发生改变的时候<code>onTouchEvent(MotionEvent)</code>都会被回调. 并且<code>MotionEvent</code>会保存当前时间点的所有<strong>触摸点的事件</strong>.</p>
<hr>
<p>举例一个场景: <strong>当三个手指同时按下</strong></p>
<p>首先系统内部有一个保存当前多点触摸事件的<strong>集合</strong>,由于跟进源码后发现方法调用的是本地方法,所以只能从出现的规律可以反推出这个集合应该是一个<strong>队列</strong>.从以下结果也可以看出.</p>
<p>虽然三个手指同时按下, 但是会依次触发<code>onTouchEvent()</code>回调. 也就是说会走三遍此回调. 当第一个触摸事件发生<code>down</code>时. 系统会创建保存一个事件对象并给这个对象的<code>pointerID</code>赋一个<code>0</code>的值并放到队列的首部, 这时当多点触控的第二个触摸事件按下的时候. 系统会遍历队列中的触摸事件的<code>pointerID</code>,如果队列第一个对象的<code>pointerID</code>不等于0那么就插入在这个对象的头部,如果等于继续下一个元素,如果下一个对象的<code>pointerID为1(就是顺序递增的效果)</code>那就继续遍历下一个元素,如果不是那就插入到这个元素也就是第二个元素对象的首部, 依次类推. 当插入后, 插入元素的<strong>所在队列的位置</strong>当做第二个触控点事件的<code>pointerID</code>; 当第三个多点触控发生时, 还是会重复上面的插入规则, 这个时候会遍历到已经存在的两个触摸对象其<code>pointerID</code>是从0开始的递增,所以这个触摸事件放到这个队列的尾部, 也就是第三个触控事件的<code>pointerID=3</code>. <code>这也就是同一个时间段,不会存在相同的pointerID的原因</code></p>
<p><code>为什么要这么麻烦的说这个? 因为当多点触控的时候不弄仅通过getX()或者getY()来取得最后一个坐标点,这个方法只是返回这个队列中的第一个元素的坐标点, 而处理多点的时候我们应该知道具体是队列总的哪一个事件触发并获取其值需要getActionIndex()获得触发事件对象的位置,然后通过getX(actionIndex)才能获取真正的发生变化的触摸点, 而且我们自己在本地记录的出现过得Path路径轨迹进行存储整理. 所以我们需要一个唯一标示来区分不同的触控点进行后续的操作</code></p>
<p><img src="http://szysky.com/2016/09/26/%E3%80%8AAndroid-%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98%E3%80%8B04-%E7%95%8C%E9%9D%A2%E6%93%8D%E4%BD%9C-Service/multitouch_add.png" alt="img"></p>
<p><strong>而获取这个触控的事件的队列虽然在插入的时候会保证返回的所在队列的位置和其pointerID一致, 但是在连续抬起事件队列删除的元素时候有序队列元素的位置会变化, 就会导致这两个值有所不同, 请看下图</strong></p>
<p><img src="http://szysky.com/2016/09/26/%E3%80%8AAndroid-%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98%E3%80%8B04-%E7%95%8C%E9%9D%A2%E6%93%8D%E4%BD%9C-Service/multitouch_action_index.png" alt="img"></p>
<p>上图和实现代码中有一个<code>getActionIndex()</code>获得的<code>ActionIndex</code>的int值.<strong>这个值表示触发事件对象所在系统保存的所有还在运行的事件的队列的位置.</strong> 当我们知道是一个队列的时候规律也就不难推出<code>move事件</code>的时候, 此值不会发生改变. 但是当<code>down和up事件的时候</code>会动态变化. 因为队列前面元素的变化会导致后边的元素.</p>
<p>这里可能我说的有点啰嗦, 如果看不懂解释可以去上面的连接地址down下代码, 观察输出日志即可.</p>
<hr>
<p><code>Android</code>中的<code>MotionEvent</code>类是所有<code>pointer</code>相关的操作的核心类, <code>pointer</code>意味着手指, 手写笔, 电脑鼠标或者一个外部的触摸板.</p>
<h3 id="PointerCoordinates"><a href="#PointerCoordinates" class="headerlink" title="PointerCoordinates"></a>PointerCoordinates</h3><p>这个知识点只做了解, 因为关于触摸压力值并不是真正的支持, 有的是由按下面积和或者获得的值就是恒定的.</p>
<p><code>MotionEvent</code>对象包含<code>pointer</code>的所有信息. 不同类型的的输入设备, 手指, 鼠标等都能生成<code>pointer</code>, 所以<code>MotionEvent</code>不仅包含x,y坐标. Android API支持所有<code>Linux</code>内核定义的输入设备. 因为不同设备的输入参数可能不同, 所以<code>pointer</code>被设计成有多个坐标轴. 最常用的就是坐标轴xy. 但也有描述其他信息的坐标轴, 比如压力, 距离, 方向等.</p>
<p>另外<code>MotionEvent</code>类不仅支持生成<code>pointer</code>坐标的输入设备, 还支持游戏控制相关的坐标轴信息以及诸如节流阀, 方向舵, 倾斜, 滚轮之类的输入来源.</p>
<h3 id="旋转手势"><a href="#旋转手势" class="headerlink" title="旋转手势"></a>旋转手势</h3><p><code>Android API</code>中有两个工具类能帮助开发者检测各种手势, <code>GestureDetector</code>类和<code>ScaleGestureDetector</code>类. 第一个类支持一些简单的触控手势: 比如长按, 双击, 快速滑动. 第二个类能检测类似于地图所用的双指缩放手势, 以及图片的放大手势等.</p>
<p>类似这样的效果:</p>
<p><img src="http://szysky.com/2016/09/26/%E3%80%8AAndroid-%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98%E3%80%8B04-%E7%95%8C%E9%9D%A2%E6%93%8D%E4%BD%9C-Service/rotate.gif" alt="img"></p>
<p>代码就不贴了, 有兴趣<a href="http://szysky.com/2016/09/26/%E3%80%8AAndroid-%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98%E3%80%8B04-%E7%95%8C%E9%9D%A2%E6%93%8D%E4%BD%9C-Service/" target="_blank" rel="external">类链接地址</a></p>
<h3 id="OpenGL-ES"><a href="#OpenGL-ES" class="headerlink" title="OpenGL ES"></a>OpenGL ES</h3><p>虽然可以使用SDK提供的部件, 或者使用自定义的视图来构建大部分的Android应用, 但有时需要更底层和更高性能的图形API. 主要用于游戏. <code>OpenGL ES</code>(嵌入式子系统)很适合. Android系统最高支持<code>OpenGL ES 3.0版本</code>主要取决于硬件和android版本. <code>Android 4.3</code>支持最新的3.0标准.</p>
<p>Android已经在标准UI框架中使用<code>OpenGL ES 2.0</code>来启动硬件加速, 但是并没有对开发者开放. 而3.0完全向后兼容2.0的. 所以如果使用3.0可以放心使用.</p>
<p>如果想要了解<code>Android上的OpenGl</code>, 可以在官网,这里跳转<a href="https://developer.android.com/guide/topics/graphics/opengl.html" target="_blank" rel="external">到Google介绍openGL</a></p>
<h2 id="重识Service"><a href="#重识Service" class="headerlink" title="重识Service"></a>重识Service</h2><h3 id="何时并如何使用Service"><a href="#何时并如何使用Service" class="headerlink" title="何时并如何使用Service"></a>何时并如何使用Service</h3><p><code>Android</code>文档关于<code>Service</code>组件的描述如下:</p>
<blockquote>
<p>Service组件表示在不影响用户的情况下执行耗时的操作或者提供给其他应用使用的功能.</p>
</blockquote>
<p>即使使用<code>Service</code>还是需要把耗时的任务放到一个独立的线程中, 那为什么还有服务的出现?</p>
<p>因为<code>Service</code>和<code>Activity</code>有着不同的生命周期, 对比起来<code>Service</code>更适合管理耗时的操作.</p>
<p>那么耗时操作的定义, 其实建议把所有和用户界面无关的操作都放到后台线程去执行. 因为UI线程需要保持高度响应来与用户进行交互. 所以应尽可能排除掉一切可以不影响用户界面响应速度的操作.</p>
<h3 id="Service类型"><a href="#Service类型" class="headerlink" title="Service类型"></a>Service类型</h3><ol>
<li><strong>用来执行和用户输入无关的操作</strong>. 例如音乐播放器能够在用户从前台退出应用的情况下还能继续播放音乐. 或者例如即时通讯应用, 在用户退出前它要一直保持运行并接收消息.</li>
<li><strong>直接由用户触发</strong> 比如照片共享应用, 用户拍完照后, 应用使用<code>Intent</code>把照片发送给<code>Service</code>(更准确地说是使用指向本地的Uri). 接下来<code>Service</code>启动并解析<code>Intent</code>里的数据, 最后在后台线程中上传该照片. 当操作完成后系统会自动停止<code>Service</code>.</li>
</ol>
<h3 id="Service的创建和销毁"><a href="#Service的创建和销毁" class="headerlink" title="Service的创建和销毁"></a>Service的创建和销毁</h3><p><code>service</code>有两个必定会调用的生命回调周期<code>onCreate()</code>和<code>onDestroy()</code></p>
<ul>
<li><code>onCreate():</code>做一些初始化例如初始化新的<code>Handler</code>对象, 获取系统服务, 注册广播, 以及执行<code>service</code>操作需要的其他初始化工作. <strong>请注意这个生命周期可是运行主线程的,如果要执行耗时操作需要使用AsyncTask,Handler等方法</strong></li>
<li><code>onDestroy():</code>所有的清理工作都应该在<code>onDestroy()</code>方法完成, 特别的, 需要停止所有已经启动的<code>HandlerThread</code>对象, 并且注销之前注册的广播. 同样, 此回调也是运行在主线程中, 所以清理工作同样放在单独线程.</li>
</ul>
<h3 id="启动Service"><a href="#启动Service" class="headerlink" title="启动Service"></a>启动Service</h3><p><code>Service</code>的启动方式有两种: 通过<code>Content.startService()</code>或者<code>Content.bindService()</code>.</p>
<p>这里先说<code>startService()</code>方法:</p>
<p>当以<strong>启动模式</strong>打开<code>Service</code>时, 参数中的<code>Intent</code>必须匹配<code>Service</code>定义的<code>intent-filter</code>. (也可以显示地使用<code>Service</code>的<code>ComponentName</code>而不再定义<code>intent-filter</code>). 该方法不提供任何对<code>Service()</code>的引用, 但它在执行基于消息的触发操作方面很有用. 该方法适合执行由用户触发并且运行时间不确定的操作, 比如上传照片或者向服务器发送状态更新. 它在为其他应用提供简单的接口方便也很有用.</p>
<p>当时用<strong>启动模式</strong>打开服务的时候, <code>Service#onStartCommand()</code>方法会被调用, 并收到发送给<code>Service</code>的<code>Intent</code>. 该方法返回一个整型常量, 用来告诉系统如何处理<code>Service</code>的重启操作. 这是<code>Service</code>比较复杂的部分, 所以最起码要记住以下三种返回值(真正返回不止3种):</p>
<ul>
<li><code>START_STICKY:</code> 代表当系统由于某些原因关闭<code>Service</code>时(通常是由于内存不足). <code>Service</code>会被重新启动. 然而当系统重新启动<code>Service</code>时, <code>onStartCommand()</code>参数中的<code>Intent</code>会被置为<code>null</code>, 请注意这一点. 使用<code>START_STICKY</code>返回值的一个典型例子就是音乐播放器.</li>
<li><code>START_NOT_STICKY:</code> 表示<code>Service</code>不会再系统关闭之后重新启动. 这在使用<code>Service</code>执行一次性操作的时候特别有用, 比如上传的东西到服务器. 如果Service在完成任务前就被系统关闭了, 它不应该再尝试重复之前的操作.</li>
<li><code>START_REDELIVER_INTENT:</code> 它和<code>START_STICKY</code>基本一样, 不过当系统重启<code>Service</code>时, <code>onStartCommand()</code>会收到<code>Service</code>被销毁之前接收到的最后一个<code>intent</code>.</li>
</ul>
<hr>
<p><strong>接着说onStartCommand()这个回调方法的一共有三个返回值:</strong></p>
<ul>
<li><code>intent:</code> 根据前面讲解返回值的时候可以看出在某些特定情况下, 该参数可能会为null.</li>
<li><code>标志位:</code> 标识本次启动请求, 可能的值为0, <code>START_FLAG_RETRY</code>, <code>START_FLAG_REDELIVERY</code>.</li>
<li><code>startId:</code> 如果多次调用<code>onStartCommand()</code>且需要安全地停止<code>Service</code>, 此参数会有用.</li>
</ul>
<h3 id="绑定Service"><a href="#绑定Service" class="headerlink" title="绑定Service"></a>绑定Service</h3><p><strong>绑定模式</strong>这是使用<code>Content.bindService()</code>. 被绑定的<code>Service</code>会一直运行, 知道所有绑定的客户端都断开后才会停止. 在同一个应用进程中绑定<code>Service</code>只需获取<code>Service</code>对象的的引用, 并调用对象相应的方法即可. 这种方式成为<code>本地binder</code>.</p>
<p>如下代码: 只贴出核心代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> *  实现一个bindService模式的, 简单演示方法被调用的服务类</div><div class="line"> */</div><div class="line">public class LocalService extends Service &#123;</div><div class="line"></div><div class="line">    public void doBackgroundOperation()&#123;</div><div class="line">        Toast.makeText(getApplicationContext(), &quot;定义服务方法被调用&quot;, Toast.LENGTH_SHORT).show();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public IBinder onBind(Intent intent) &#123;</div><div class="line">        return new LocalBinder();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public class LocalBinder extends Binder&#123;</div><div class="line">        public LocalService getService()&#123;</div><div class="line">            return LocalService.this;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">// 在Activity中进行强转即可</div><div class="line">serviceConnection = new ServiceConnection() &#123;</div><div class="line">  @Override</div><div class="line">  public void onServiceConnected(ComponentName name, IBinder service) &#123;</div><div class="line">      mService = ((LocalService.LocalBinder)service).getService();</div><div class="line">      //  通过mService就可以调用服务的内部方法, 注意这只是在应用内部, 不可以跨进程</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  @Override</div><div class="line">  public void onServiceDisconnected(ComponentName name) &#123;</div><div class="line">      mService = null;</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="保持活跃"><a href="#保持活跃" class="headerlink" title="保持活跃"></a>保持活跃</h3><p>当服务已经启动, 并且应用程序在前台运行(当前正在展示应用的某个Activity), 那么该<code>Service</code>会是最后一个被杀死. 然而一旦用户离开了发起服务的应用, 那么此服务也就不再是前台应用, 有可能会被杀死. 所以如果需要在应用不处于前台活动状态下仍然保持<code>Service</code>在前台运行, 则可以调用<code>Service.startForeground()</code>. (当应用程序更新可以使用<code>Notification</code>通知配合服务来完成)</p>
<blockquote>
<p>系统会试图尽可能长地保持<code>Service</code>处于活动和运行状态. 只有当资源耗尽, 通常是没有足够内存(RAM), 才有可能会去停止<code>Service</code>. 当是我们应该在开发中假设这种情况会随时发生.</p>
</blockquote>
<h3 id="停止服务Service"><a href="#停止服务Service" class="headerlink" title="停止服务Service"></a>停止服务Service</h3><p>一旦<code>Service</code>启动, 它会尽可能长时间运行. 根据启动方式的不同, 系统会在系统资源不足杀死<code>Service</code>后重启.</p>
<blockquote>
<p>当Service再次启动时, 可能会出现一些意想不到的结果, 所以适当的停止服务就显得很重要.</p>
</blockquote>
<ul>
<li><code>绑定模式:</code> 此模式下服务会一直运行到没有客户端连接为止. 但有一种例外情况, 即最后连接的客户端调用了<code>Service.startForeground()</code>时还会保持<code>Service</code>的运行, 所以需要在适当的时候调用<code>Service.stopForeground()</code></li>
<li><code>启动模式:</code> 只能通过<code>Service.stopSelf()</code>或者<code>Content.stopService()</code>来停止<code>Service</code>. 这标志着需要停止和移除<code>service</code>. 而重新启动<code>Service</code>的唯一方式是显示调用<code>Content.startService()</code>或者<code>Content.bindService()</code>. 注意, 当通过<code>startService()</code>启动服务时, 不管调用多少次<code>onStartCommand()</code>(即调用<code>Content.startService()</code>不会叠加), 调用<code>Service.stopSelf()</code>或者<code>Content.stopSelf()</code>一定会停止服务.</li>
</ul>
<h3 id="后台运行的IntentService"><a href="#后台运行的IntentService" class="headerlink" title="后台运行的IntentService"></a>后台运行的IntentService</h3><p>普通的服务的生命周期回调都是触发在<strong>主线程上</strong>. 如果需要处理耗时操作那么需要把耗时操作移动到一个单独的线程中.</p>
<p><strong>IntentService</strong></p>
<p>由于<code>Handler</code>在android中的处理消息的便利, 和<code>Service</code>分离与UI线程无关的代码. 所以google提供了一个名为<code>IntentService</code>的工具类, 它在<code>Service</code>中包装了一个处理后台线程的<code>Handler</code>. 开发者只需要继承该类, 实现<code>onHandlerIntent()</code>方法, 并添加希望<code>Service</code>能够接收的action.</p>
<p><code>onHandlerIntent()</code>方法运行在自己线程, 并不一定是主线程. 并且每次只能处理一个<code>Intent</code>,当处理结束之后服务也就自动关闭. 可以通过不同的<code>action</code>组装成intent, 也可以给<code>intent</code>附加信息, 用以在服务中区分不同的动作请求. 当多次通过<code>startService()</code>调用服务的时候, 每次调用的<code>Intent</code>会被保存到队列中, 所以该类能确保任意时间只会有一个<code>intent</code>会被处理. 知道队列为空, 那么服务也就随之消失.</p>
<hr>
<p><strong>并行问题</strong></p>
<p><code>IntentService</code>虽然方便好用, 并且能够顺序处理同一时间内的多个请求. 但是正因为是<strong>串行的处理模式</strong>, 可能我们有的时候更需要并行更快的处理完成.如果是这样, 那我们就使用线程池来处理. 可以在<code>AsyncTask</code>中使用<code>Executor</code>并行地执行操作. 但是<code>AsyncTask</code>的特点是比较适合执行运行时间至多几面的操作, 如果要执行比较耗时的操作. 可以使用<code>ExecutorService</code>使用<code>Executors.newCacheThreadPool()</code>.</p>
<h3 id="对Service的通信"><a href="#对Service的通信" class="headerlink" title="对Service的通信"></a>对Service的通信</h3><p>前面记录了何时使用, 如何执行. 那么接下来接说一下对服务的通信. 一般有两种:</p>
<ul>
<li><code>Content.StartService()</code>会把<code>Intent</code>分发给<code>Service.onStartCommand()</code>方法,可以在该方法中触发后台操作, 然后通过广播或者其他方式再把结果分发给调用组件.</li>
<li><code>Content.bindService()</code>方法可以获得<code>Binder</code>对象, 使用它可以直接调用<code>Service</code>对象.</li>
</ul>
<hr>
<p><strong>使用Intent进行异步消息的传递</strong></p>
<p>如果想要知道服务中处理的结果, 只需要采用发送广播的进行通知调用者即可.</p>
<p>总结一下这种的优缺点:</p>
<ul>
<li><strong>优点:</strong> Android提供了线程的机制, 而不需要开发者自己构建复杂的组件间消息处理系统. 开发者只需要声明表示异步消息的<code>action</code>. 并在响应的组件中注册这些广播. 即便<code>Service</code>属于其他应用或者运行在一个单独的进程中, 该方法同样有效.</li>
<li><strong>缺点:</strong> 通知的结果受限于<code>Intent</code>. 此外这种方式不适合在<code>IntentService</code>和<code>Activity</code>之间进行大规模快速更新的操作, 比如更新进度条, 因为这会阻塞系统. 如果确定需要实现此功能那么可以使用<code>bindService</code>.</li>
</ul>
<hr>
<p><strong>本地绑定的Service进行的交互</strong></p>
<p>当<code>Service</code>提供的接口太过复杂, 很难用<code>Intent</code>消息机制解决, 而普通的<code>Java</code>方法又可以很好的解决这个问题; 另一个使用绑定本地<code>Service</code>的原因是可以在<code>Service</code>中给Activity提供更为复杂的回调. 因为那些耗时的操作必须放到<code>Service</code>的后台线程, 所以<code>Service</code>的大部分回调应该是异步的. 实际的调用触发后台操作立即返回, 一旦操作完成, <code>Service</code>使用回调接口来通知<code>Activity</code>响应的执行结果.</p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://yoursite.com/2017/09/11/android/books/《Android 编程实战》Chap4_手势操作进阶, 重识Service/" data-id="cj7g7uqlr000616pjj48lo4s5" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    
        <a href="http://yoursite.com/2017/09/11/android/books/《Android 编程实战》Chap4_手势操作进阶, 重识Service/#comments" class="article-comment-link">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-android/books/《Android 编程实战》Chap3_组件 清单 资源和UI闲聊" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/09/11/android/books/《Android 编程实战》Chap3_组件 清单 资源和UI闲聊/">《Android 编程实战》Chap3_组件 清单 资源和UI闲聊</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/09/11/android/books/《Android 编程实战》Chap3_组件 清单 资源和UI闲聊/">
            <time datetime="2017-09-11T13:36:06.000Z" itemprop="datePublished">2017-09-11</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/android/">android</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/android/《Android-编程实战》/">《Android 编程实战》</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/android/">android</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <blockquote>
<p>阅读《Android 编程实战》一书的随记笔记<br>注：本文主要参考<a href="http://szysky.com" target="_blank" rel="external">http://szysky.com</a></p>
</blockquote>
<h2 id="应用程序清单"><a href="#应用程序清单" class="headerlink" title="应用程序清单"></a>应用程序清单</h2><blockquote>
<p><code>AndroidManifest</code>是一个定义各种组件以及应用程序各个方向的XML文件. 该清单是所有<code>Android</code>的核心.</p>
</blockquote>
<h3 id="manifest元素"><a href="#manifest元素" class="headerlink" title="manifest元素"></a>manifest元素</h3><p><code>AndroidManifest.xml</code>文件的根节点元素是<code>manifest</code>. 应用程序的<strong>包名</strong>和<strong>唯一识别符</strong>都定义在该节点. 还可以在该节点中定义<code>Linux用户ID</code>和<code>名称(应用程序将运行在该ID下)</code>. 应用的版本, APK的安装位置.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    package=&quot;com.test.printertestdemo&quot;</div><div class="line">    android:sharedUserId=&quot;com.szysky.userid&quot;</div><div class="line">    android:sharedUserLabel=&quot;@string/user_name&quot;</div><div class="line">    android:installLocation=&quot;auto&quot;</div><div class="line">    android:versionCode=&quot;6&quot;</div><div class="line">    android:versionName=&quot;2.0&quot; &gt;</div><div class="line">    </div><div class="line">&lt;/manifest&gt;</div></pre></td></tr></table></figure>
<p>这是一个比较完整的配置. <code>sharedUserId</code>和<code>sharedUserLabel</code>是Linux用户ID和名称. 应用程序将会运行在上面. 默认情况下, 这些都是系统分配的. 如果为使用证书发布的多个应用设置同样的值时, 开发者就可以访问相同的数据, 并有可能可以共享这些应用的进程(下面说道).</p>
<p>多个应用共享同一个进程可以节省应用程序使用的<code>RAM</code>总量. 但当其中一个应用出现运行时错误, 那所有共享相同进程的其他应用也会崩溃.</p>
<p>使用<code>installLocation</code>属性来控制应用程序的安装位置. 即可以在设备的内部存储器(data分区)安装应用程序, 也可以在外部存储装置(SD卡)安装. 需要注意: 只能通过这个属性控制APK的<strong>安装位置</strong>. 应用程序数据仍然安全地存储在内部存储器中.</p>
<h3 id="user-feature"><a href="#user-feature" class="headerlink" title="user-feature"></a>user-feature</h3><p>这个属性元素<code>&lt;user-feature&gt;</code>可以让<code>Google Play</code>去过滤应用在哪台设备可见. 比如应用需要一个打电话的功能, 但是当前设备只支持wifi的平板电脑. 或者说一个Android电视是不支持触屏控制, 但是应用需要这个硬件特性的支持. 就可以通过这个属性设置.</p>
<p>例如:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;user-feature android:name=&quot;android.hardware.microphone&quot;&gt;</div><div class="line">&lt;!--需要电话功能支持--&gt;</div><div class="line">&lt;user-feature android:name=&quot;android.hardware.telephony&quot;&gt; </div><div class="line">&lt;!--支持多点触控的触摸屏--&gt;</div><div class="line">&lt;user-feature android:name=&quot;android.hardware.touchscreen.multitouch.jazzhand&quot;&gt;</div></pre></td></tr></table></figure>
<h3 id="application"><a href="#application" class="headerlink" title="application"></a>application</h3><p>使用自定义的<code>Application</code>必须要做的就是在清单文件中指定<code>&lt;application&gt;</code>中的<code>name</code>属性到自定义的application.</p>
<p>列举一下属性:</p>
<ul>
<li><code>label</code>, <code>description</code>: 可以让用户在设置页面中看到关于应用的更多详细的描述.</li>
<li><code>android:backupAgent</code>: 这是<code>Google</code>提供的一个备份服务, 需要实现自己的<strong>备份代理</strong>的类,并使用此属性指向此类.</li>
<li><code>android:largeHeap</code>: 可以让系统知道需要更多的内存. 但是, 除非特别需要, 否则不要这么做. 因为这样做会浪费系统资源,而且<strong>系统会更快的终止应用程序</strong>.</li>
<li><code>android:process</code>: 当多应用程序共享一个用户ID, 并且<code>process</code>属性设置为一个值的时候, 可以<strong>强制这些应用共享同一个进程</strong>. (所以如果需要使多应用使用一个进程, 那么所有的应用必须共享同一个用户ID并同一个证书签名和相同的process)</li>
<li><code>android:theme</code>: 属相设置整个应用的主题.</li>
</ul>
<h3 id="组件元素和属性"><a href="#组件元素和属性" class="headerlink" title="组件元素和属性"></a>组件元素和属性</h3><p>每个标准组件(<code>activity</code>, <code>service</code>, <code>broadcastReceiver</code>, <code>contentProvider</code>)在清单文件都有自己的节点元素, <code>AS</code>创建的默认属性通常能满足大部分情况. 下面看一下其他的属相把</p>
<hr>
<p><strong>android:enabled = “false”</strong></p>
<p>我们所定义的所有组件默认都是<strong>可用的</strong>. 当把enable设置为false的时候, 可以修改默认行为, 这将阻止组件接收<code>Intent</code>.</p>
<ul>
<li>禁用的<code>Activity</code>不会显示在应用程序启动器中;</li>
<li>禁用的<code>Service</code>不会响应<code>startService()</code>调用;</li>
<li>禁用的<code>BroadcastReceiver</code>不会监听<code>BroadcastIntent</code>;</li>
<li>禁用的<code>ContentProvider</code>不会响应<code>ContentResolver</code>.</li>
</ul>
<p>代码中同样可以设置:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">PackageManager pm = getPackageManager();</div><div class="line">		</div><div class="line">// 启用一个activity</div><div class="line">pm.setComponentEnabledSetting(new ComponentName(this, MainActivity.class),</div><div class="line">		PackageManager.COMPONENT_ENABLED_STATE_ENABLED,</div><div class="line">		PackageManager.DONT_KILL_APP);</div><div class="line">	</div><div class="line">// 禁用一个activity</div><div class="line">pm.setComponentEnabledSetting(new ComponentName(this, MainActivity.class),</div><div class="line">		PackageManager.COMPONENT_ENABLED_STATE_DISABLED,</div><div class="line">		PackageManager.DONT_KILL_APP);</div></pre></td></tr></table></figure>
<hr>
<p>有时候出于安全的原因, 我们不希望把某个组件暴露给系统的其他应用使用, 这时可以通过<code>android:exported=&quot;false&quot;</code>, 这会有效地把对外可被调用属性关闭.</p>
<hr>
<p>如果你想设置一个组件供其他应用使用, 但又想提供某个安全级别, 则可以<strong>定义权限</strong>, 要做到这一点, 那么调用者应该在清单文件中添加使用权限(user-permission), 然后在提供者应用注册一个权限(permission).</p>
<h3 id="Intent过滤"><a href="#Intent过滤" class="headerlink" title="Intent过滤"></a>Intent过滤</h3><p>在<code>Android</code>中所有的组件都是通过<code>Intent</code>访问的, <code>Intent</code>抽象地描述了要执行的动作. <code>Intent</code>会被发送给<code>Activity</code>, <code>Service</code>, <code>BroadcastReceiver</code>. 一旦发送, <code>Android系统</code>的Intent将决定将Intent分发给哪个组件.</p>
<ol>
<li><code>Intent</code>要确认的第一件事情就是分辨出<strong>隐式</strong>还是<strong>显示</strong>. <code>显示Intent</code>包含有关包和组件的名称信息, 他们可以立即分发, 因为只能匹配到一个组件. 此方法通常应用于程序内部的通信. <code>隐式Intent</code>的取决于三个因素: <strong>action</strong>, <strong>数据的URI和类型</strong>, <strong>以及类别</strong>. 注意: <strong>extras和flags对Intent区分没有影响</strong></li>
<li><code>action</code>是最主要的, 通常也是唯一应该重点关注的. Android有许多预定义的action, 开发者也可以定义自己的action. 开发者定义自己的action时, 通常在前面加上自己的包名, 这样不同应用之间action定义的冲突也就基本不存在了.</li>
<li><code>data</code>并没有实际的数据, 只是包含了<code>URI</code>和<code>MIME</code>类型, 使用<code>Activity</code>打开只包含特定类型文件会非常有用.</li>
<li><code>category和Activity最相关</code>. 所有通过<code>startActivity()</code>发送的隐式Intent都至少定义了一个<code>category(android.intent.category,DEFAULT)</code>, 所以除非Activity的<code>Intent-filter</code>也包含这个<code>category</code>. 否则就不会通过<code>Intent</code>的匹配. 比较例外的是图标启动器的<code>intent-filter</code></li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;activity</div><div class="line">  android:name=&quot;.PrinterTestDemoAct&quot;</div><div class="line">  android:label=&quot;@string/app_name&quot;&gt;</div><div class="line">  &lt;intent-filter&gt;</div><div class="line">      &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;</div><div class="line">      &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;</div><div class="line">  &lt;/intent-filter&gt;</div><div class="line">  </div><div class="line">  &lt;intent-filter&gt;</div><div class="line">      &lt;action android:name=&quot;android.intent.action.VIEW&quot;/&gt;</div><div class="line">      &lt;category android:name=&quot;android.intent.category.DEFAULT&quot;/&gt;</div><div class="line">      &lt;data android:mimeType=&quot;video/*&quot;/&gt;</div><div class="line">  &lt;/intent-filter&gt;</div><div class="line">&lt;/activity&gt;</div></pre></td></tr></table></figure>
<p>如上清单配置: 有两个<code>intent-filter</code>, 第一个是用于桌面图标启动应用; 第二个是用于打开video开头的<code>MIME</code>类型文件.</p>
<p>第一个<code>intent-filter</code>不需要<code>category.DEFAULT</code>. 因为它将由启动器程序管理.<br>第二个<code>intent-filter</code>是我们经常使用<code>startActivity()</code>方法会匹配到的, 所以其中的<code>category</code>应该设置<code>default</code>, 无论被打开视频文件是本地还是网络, 只要<code>MIME</code>类型以<code>Video</code>开头就行.</p>
<h2 id="resources-和-assets"><a href="#resources-和-assets" class="headerlink" title="resources 和 assets"></a>resources 和 assets</h2><p>开发中除了实现业务逻辑的代码, 还有就是一些像<code>XML布局</code>,<code>图标</code>,<code>文本值</code>等这样的内容, 这些静态内容存储在APK文件的<code>resources</code>或者<code>assets</code>目录中. 所有的组员都属于一个特定的类型(比如layout, drawable等), 而<code>assets</code>是简单地存储在应用内的通用文件. 大多数非代码的内容都以资源的形式呈现, 因为他们紧密集成在Android API中.</p>
<p>从开发的角度来看, Android中的资源特性是平台最强大的功能之一, 它允许开发者根据<strong>屏幕尺寸</strong>, <strong>定位参数</strong>, <strong>设备能力</strong>等来提供多个版本的资源. 最常见的解决方案是通过在不同的文件中提供多个版本的文本字符串来支持多语言, 或者通过提供不同的布局文件和不同大小的图标来支持各种屏幕的尺寸.</p>
<hr>
<p><strong>在应用中定义资源要遵循的几个规则</strong></p>
<ol>
<li>一定要在应用中为每种类型的资源都提供一个默认值, 就是在没有任何限定符的资源目录中提供默认的图片, 图标, 文本字符串和布局. 确保当所有特定资源文件都无法匹配设备, 可以加载默认的资源而不会出现崩溃.</li>
<li>避免硬编码, 例如字符串和值. 虽然可能会需要做一些额外工作也不算太累, 相比与之后当需要改变整个应用中的所有字体, 外边距, 内边距, 增加字符串本地化的时候. 修改起来这简直就是轻而易举的简单.</li>
<li>通过提供<strong>限定符</strong>来过滤资源. 例如, 如果想为高密度像素的设备提供一套高分辨率的图标, 可以通过<code>drawable-xxxhdpi</code>目录内存储</li>
</ol>
<hr>
<h3 id="高级String资源"><a href="#高级String资源" class="headerlink" title="高级String资源"></a>高级String资源</h3><p>通常, 应用中的所有字符串都应该放在<code>string</code>资源中. 这样比在java代码中相比, 可以消除一下问题, 特别是当涉及格式化字符串和本地化时.</p>
<p>比如: 在<code>string.xml</code>声明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;string name=&quot;personal_message&quot;&gt;Hi %s !&lt;/string&gt;</div><div class="line"></div><div class="line">&lt;string-array name=&quot;default_categories&quot;&gt;</div><div class="line">   &lt;item&gt;Work!&lt;/item&gt;</div><div class="line">   &lt;item&gt;personal&lt;/item&gt;</div><div class="line">&lt;/string-array&gt;</div></pre></td></tr></table></figure>
<p>在java中使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">String oneStr = getString(R.string.personal_message, &quot;suzeyu&quot;);</div><div class="line">		String[] stringArray = getResources().getStringArray(R.array.default_categories);</div></pre></td></tr></table></figure>
<p>第一个在获取string资源的时候, 传入了一个字符串参数, 并在<code>%s</code>处进行插入处理.</p>
<h3 id="本地化"><a href="#本地化" class="headerlink" title="本地化"></a>本地化</h3><p>要做到本地化的支持, 把默认字符串资源复制到一个适当语言和地区限定符的新目录中, 然后开始翻译文本.</p>
<p>如果要翻译一种语言的资源文件到另一种语言, 你可以通过使用<strong>谷歌翻译工具Google Translator ToolKit</strong>, 这是谷歌的一个服务, 允许上传一个文件, 然后将字符串自动翻译为指定的语言.</p>
<h3 id="使用assets"><a href="#使用assets" class="headerlink" title="使用assets"></a>使用assets</h3><p>如果有一些较大的资源文件可以考虑放到<code>assets</code>和<code>raw</code>目录下.</p>
<p>考虑这样一种场景, 如果有一个游戏有许多的音效, 那么就可以在<code>assets</code>文件夹内创建一个<code>soundfx</code>目录, 接下来把所有的音频文件都放入此子目录中. (<code>assets</code>目录支持子文件夹)</p>
<p>如下代码显示了如何使用<code>SoundPool</code>和<code>AssetManager</code>来加载<code>assets/soundfx</code>目录内的所有音频文件. 并且最后关闭打开的文件, 防止内存泄漏.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">public HashMap&lt;String, Integer&gt; loadSoundEffects(SoundPool soundPool) throws IOException&#123;</div><div class="line">		// 获取assets资源管理者</div><div class="line">		AssetManager assets = getAssets();</div><div class="line">		String[] soundEffectFiles = assets.list(&quot;soundfx&quot;);</div><div class="line">		HashMap&lt;String, Integer&gt; soundEffectMap = new HashMap&lt;String, Integer&gt;();</div><div class="line"></div><div class="line">		for (String soundEffectFile: soundEffectFiles) &#123;</div><div class="line">			AssetFileDescriptor fileDescriptor = assets.openFd(&quot;soundfx/&quot; + soundEffectFile);</div><div class="line">			int id = soundPool.load(fileDescriptor, 1);</div><div class="line">			soundEffectMap.put(soundEffectFile, id);</div><div class="line">			</div><div class="line">			fileDescriptor.close();</div><div class="line">		&#125;</div><div class="line">		return soundEffectMap;</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<h2 id="UI的一些小知识"><a href="#UI的一些小知识" class="headerlink" title="UI的一些小知识"></a>UI的一些小知识</h2><h3 id="文本"><a href="#文本" class="headerlink" title="文本"></a>文本</h3><p><strong>字体:</strong>人脑利用图像识别来分辨不同的字母汉字, 所以逻辑上来说, 应该使用很容易辨认的字体, 而高度装饰字体只适用于标识(logo)等其他场合.</p>
<hr>
<p><strong>文本布局:</strong>例如报纸中的布局分成若干个专栏, 人们更偏向于稍微适中, 比较短的文本阅读. 所以切记不要让你的文本布局显示一行很长很长的文字. 尽量可以保持一行在<code>45~72</code>个字符.</p>
<hr>
<p><strong>android中的大小单位</strong></p>
<ul>
<li><code>dp</code> (density-independent) 控制控件大小</li>
<li><code>sp</code> 基于dp产生, 主要用于文字大小</li>
<li><code>pt</code> (points, 磅)</li>
<li><code>px</code> (pixel, 像素)</li>
<li><code>mm</code> (millimeter, 毫米)</li>
<li><code>in</code> (inch, 英寸)</li>
</ul>
<hr>
<p><strong>推荐尺寸:</strong>一个按钮一个比较好的大小值为<code>48dp</code>转换之后相当于9毫米, 这个尺寸可以让用户手指在触摸屏上轻松的交互.</p>
<hr>
<p><strong>图标大小:</strong>针对之前说的<code>48dp</code>,当不同分辨密度下相对应的为 48像素(MDPI), 72像素(HDPI), 96像素(XHDPI), 以及144像素(XXHDPI). 这就是所谓的2:3:4:6. 对应的DPI分别指~160, ~240, ~320, ~480.</p>
<p>如果将位图作为图标使用, 那么就应该使用dp而不是像素为单位. 一个正常的图标, 如主屏幕上的启动图标, 应该为<code>48dp*48dp</code>, 而操作栏(action bar)的图标为<code>32dp*32dp</code>, 通知栏的图标<code>24dp*24dp</code></p>
<hr>
<p><strong>字体的大小:</strong>谷歌创建的<code>Roboto</code>字体被用于所有标准的Android程序. 不同的字体的尺寸即使一样, 实际看起来可能也会不同, 主要是因为他们的<code>x-height</code>不同, <code>x-height</code>即为当前字体小写字母x的高度. 经常使用的<code>x-height</code>较大的字体有<code>Arial</code>和<code>Verdana</code></p>
<p>谷歌为Android字体定义了四个标准大小:</p>
<ul>
<li><code>micro</code> 极小, 12sp</li>
<li><code>small</code> 小, 14sp</li>
<li><code>medium</code> 中, 18sp</li>
<li><code>large</code> 大, 22sp</li>
</ul>
<hr>
<p><strong>典型透视:</strong>当我们需要凭借记忆画一个物体时, 大多数人会从一个略高于它的角度来描述它, 这就叫做<strong>典型透视</strong>.</p>
<p><strong>人脸识别:</strong>人类擅长人脸识别, 许多人可以轻松地从一堆人中挑选出自己的朋友. 实际上相对于识别物体, 我们能更快识别人脸. 此外, 我们对文字的理解远远慢于识别人脸.</p>
<hr>
<p>不要让用户思考! 用户不应该花大量时间来研究如何使用应用程序. 开发者应该让第一次看到应用程序UI的用户无需置疑下一步该如何操作;</p>
<p><strong>视觉线索</strong>是指一个物体向用户发出的如何与之交互的信息. 人们对文字的理解慢于对简单图标的理解.</p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://yoursite.com/2017/09/11/android/books/《Android 编程实战》Chap3_组件 清单 资源和UI闲聊/" data-id="cj7g7uql9000316pjn6qp7fqi" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    
        <a href="http://yoursite.com/2017/09/11/android/books/《Android 编程实战》Chap3_组件 清单 资源和UI闲聊/#comments" class="article-comment-link">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-android/books/《Android 编程实战》Chap2_Android上编写高效Java" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/09/11/android/books/《Android 编程实战》Chap2_Android上编写高效Java/">《Android 编程实战》Chap2_Android上编写高效Java</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/09/11/android/books/《Android 编程实战》Chap2_Android上编写高效Java/">
            <time datetime="2017-09-11T13:35:09.000Z" itemprop="datePublished">2017-09-11</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/android/">android</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/android/《Android-编程实战》/">《Android 编程实战》</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/android/">android</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <blockquote>
<p>阅读《Android 编程实战》一书的随记笔记<br>注：本文主要参考<a href="http://szysky.com" target="_blank" rel="external">http://szysky.com</a></p>
</blockquote>
<h2 id="Dalvik-Java和Java-SE"><a href="#Dalvik-Java和Java-SE" class="headerlink" title="Dalvik Java和Java SE"></a>Dalvik Java和Java SE</h2><p>在<code>Android</code>设备上运行的<code>VM</code>成为<code>Dalvik</code>. 适用于CPU和内存受限的移动设备. <code>Java SE</code>和<code>Dalvik Java</code>存在一些差异, 这些差异主要体现在虚拟机上.</p>
<ul>
<li><code>Java SE</code>: 使用了栈机设计</li>
<li><code>Dalvik</code>: 使用了基于寄存器的机器的设计</li>
</ul>
<p><code>Android SDK</code>中个有一个<code>dx</code>工具, 它会把<code>Java SE</code>栈机器的字节码转换成基于寄存器的<code>Dalvik</code>机器字节码, 这个步骤平时是由<code>AS</code>自动完成的.</p>
<p>虽然基于寄存器的虚拟机最多可以比基于栈的虚拟机快32%, 但这只限于执行解释代码的虚拟机. 在<code>Android 2.2</code>之前, <code>Dalvik</code>虚拟机都是纯解释性的. 之后才引入了<code>JIT</code>编译器.</p>
<p><strong>JIT编译</strong></p>
<p>也称<code>即时编译或者动态编译</code>. 它在执行前把字节码翻译成本地代码, 这样的两个好处:</p>
<ul>
<li>消除了那些纯解释性虚拟机的开销</li>
<li>它能对本机代码执行优化, 这通常是静态编译代码无法做到的.</li>
</ul>
<p>另一个区别是: <code>Dalvik</code>在开机时会启动一个<code>zygote</code>的进程, 该进程会创建第一个<code>Dalvik</code>实例, 由这个实例创建所有其他的实例. 当应用程序启动的时候, <code>zygote</code>进行会收到一个创建新虚拟机实例的请求, 并给该应用程序创建一个新进程.</p>
<hr>
<p>对于两个方向的API也不是一模一样, 比方说<code>Android</code>移除了<code>Java SE</code>中<code>Swing/AWT</code>包. 因为<code>Android</code>有自己的UI框架. 还有一些例如<code>RMI</code>, <code>CORBA</code>,<code>JMX</code>等.</p>
<h2 id="优化Android上的Java代码"><a href="#优化Android上的Java代码" class="headerlink" title="优化Android上的Java代码"></a>优化Android上的Java代码</h2><p><strong>1.更安全的队列</strong></p>
<p>例如如果需要实现一个<strong>生产者/消费者</strong>模式, 关于所使用的管理存储的集合可能需要选择队列(<code>LinkedList</code>)并且具体的存取操作要套上<code>synchronize</code>防止并发问题. 但是如果通过<code>LinkedBlockingQueue</code>就可以实现上面的手动编写的步骤. 对于做同样的事情但是更快的实现方法,我们没有例如不去使用</p>
<p>其实在<code>JDK1.5</code>之后, 提供了<code>java.util.concurrent</code>包, 这个包不仅有相关的类, 此外还包含信号量, 锁, 以及对单个变量进行原子操作的类.</p>
<hr>
<p><strong>2.更好的锁</strong></p>
<p>对于Java提供的<code>synchronize</code>关键字允许创建线程安全的代码块和方法. <code>synchronize</code>关键字虽然便于使用, 但也很容易滥用, 对性能造成损耗. 当需要区分读数据和写数据时, <code>synchronize</code>也不是最有效的.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">public class ReadWriteLockDemo &#123;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 控制读写操作并发的锁</div><div class="line">     */</div><div class="line">    private final ReentrantReadWriteLock mLock ;</div><div class="line">    private String mName;</div><div class="line"></div><div class="line">    public ReadWriteLockDemo()&#123;</div><div class="line">        mLock = new ReentrantReadWriteLock();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    public void setPersonData(String name)&#123;</div><div class="line">        // 获取写操作的锁</div><div class="line">        ReentrantReadWriteLock.WriteLock writeLock = mLock.writeLock();</div><div class="line">        </div><div class="line">        try &#123;</div><div class="line">            //  获取 写锁使用权, 其余线程需要操作只有在写锁被关闭才可以</div><div class="line">            writeLock.lock();</div><div class="line">            mName = name;    </div><div class="line">        &#125;finally &#123;</div><div class="line">            //  释放 写锁使用权 </div><div class="line">            writeLock.unlock();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    public String getName()&#123;</div><div class="line">        ReentrantReadWriteLock.ReadLock readLock = mLock.readLock();</div><div class="line">        </div><div class="line">        try &#123;</div><div class="line">            readLock.lock();</div><div class="line">            return mName;</div><div class="line">        &#125;finally &#123;</div><div class="line">            readLock.unlock();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    // 省略其余实现</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>上面代码允许多个并发线程对数据进行只读方法, 并确保同一时间只有一个线程写入数据.</p>
<h2 id="管理和分配内存"><a href="#管理和分配内存" class="headerlink" title="管理和分配内存"></a>管理和分配内存</h2><p>Java的自动内存管理有效消除了开发过程中的许多问题. 不再需要记住为每个创建的对象进行手动释放对象内存. 当时同时也需要付出一定的性能代价. <strong>自动垃圾收集器会和程序并行运行. 垃圾回收器会一直运行, 并检查是否有可以回收的内存. 这种行为意味着应用程序进程会和垃圾收集器竞争CPU时间,即使垃圾回收器不会运行太长时间,但是也是一种性能损失. 虽然我们不能抛弃这中垃圾收集方式, 但是可以有效的控制, 例如:</strong></p>
<p><strong>减少对象分配</strong></p>
<p>如果可以不要在循环内部创建对象, 在循环的外部创建对象, 并复用此对象. 减少对象的生成造成的空间开辟, 和无用对象的回收.</p>
<h2 id="Android中的多线程"><a href="#Android中的多线程" class="headerlink" title="Android中的多线程"></a>Android中的多线程</h2><p>确保不再<code>UI线程</code>做耗时操作, 这基本已经印在<code>Android</code>开发的脑袋里了. 那么如何知道一个方法是否在主线程执行? <code>Android</code>文档指出, <strong>默认情况下, 应用的所有组件都运行在同一个进程和线程中(主线程)</strong>. 更确切点的说三个组件(<code>Activity</code>, <code>Service</code>, <code>Broadcast</code>, <code>Application</code>)的所有回调基本上所有的<code>onXXXX()</code>这种命名的方法都是运行在主线程的.</p>
<hr>
<p><strong>那么什么样的代码在主线程执行才是安全的?</strong></p>
<p>只有那些必须在主线程执行的方法才能放在主线程中. 其他一切操作都应该放在另一个单独的线程中执行. 实际情况下, 那些不会耗时的操作也可以放在主线程中. 如何能确保在另一个单独的线程中执行文件, 数据库或者网络操作, 通常主线程会是安全的. 当然也要确保同一时间不会运行太多线程, 原因是<code>CPU</code>切换线程也会造成性能损失.</p>
<h3 id="Thread"><a href="#Thread" class="headerlink" title="Thread"></a>Thread</h3><p><code>Thread</code>类是<code>Android</code>中所有线程的基类, <code>Java SE</code>中也包含它. 如果要在线程中执行代码, 即可以创建一个继承, 也可以把实现<code>Runnable</code>接口的类对象传给<code>Thread</code>的构造函数.</p>
<p>对于这个基础的类, 尽量能不用就不用. 除非配合缓冲池, 不然频繁的创建新的线程开销很大.</p>
<h3 id="AsyncTask"><a href="#AsyncTask" class="headerlink" title="AsyncTask"></a>AsyncTask</h3><p>这是<code>Android</code>中比较流行的一种, 因为使用简单,并且允许定义一个运行在单独线程中的任务, 并且提供了不同阶段的回调, 如<code>doInBackground()</code>会被回调在单独的线程. 而其余的三个回调都是被回调在主线程. 这都是为了让开发者可以把代码编写的重点放在实现的功能上, 而不是考虑是否应该避免系统级的问题发生.</p>
<p>使用<code>AsyncTask</code>创建的实例只能使用一次, 这也就意味着每次执行操作都新建一个实例对象. 虽然是个轻量级的类(实际的线程是由<code>ExecutorService</code>管理的), <strong>但是不适合那些频繁的操作</strong>, 因为这会快速聚集需要垃圾回收的对象, 并最终导致应用程序的卡顿.</p>
<p>并且, <code>AsyncTask</code>不能对操作设置执行时间, 也无法间隔一段时间去执行操作. 它适合文件下载, 以及不会频繁发生或通过用户交互等类似情况的操作. 但是使用简单嘛.</p>
<h3 id="Handler"><a href="#Handler" class="headerlink" title="Handler"></a>Handler</h3><p>当需要更细粒度地控制一个单独的线程中执行操作的时候, <code>Handler</code>类会是一个很有用的工具. 该类允许准确地控制操作的执行时间. 还可以重复多次的使用. 执行操作的线程会一直运行, 直到被显示地终止. <code>Loop</code>会处理幕后的事情, 但是作为开发人员却很少和其打交道.</p>
<p>使用<code>Handler</code>类最常见的方式是发送<code>Message</code>. 当向后台线程传递数据和参数时, 这些消息对象简单,易于创建, 并且可以重用. <code>Message</code>对象通常是由它的共有整型成员变量<code>what</code>定义的. 还有两个名为<code>arg1和arg2</code>的整型成员变量, 他们用于创建低开销的的参数, 以及<code>obj</code>成员变量(可以存储任意单个对象的引用). 如果你需要存储更复杂的数据那么通过<code>setData(Bundle)</code>方法设置更复杂的数据.</p>
<hr>
<p><strong>发送消息</strong></p>
<p>既可以使用<code>Message#sendToTarget()</code>也可以使用<code>Handler#sendXXX()</code>等方法. 如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">// 创建一个带有data参数的Message, 然后立刻把它发送到handler执行</div><div class="line">Message.obtain(mHandler, FLAG_SYNC_DATA, data).sendToTarget();</div><div class="line"></div><div class="line">// 立刻给handler发送一个空消息</div><div class="line">mHandler.sendEmptyMessage(FLAG_SYNC_DATA);</div><div class="line"></div><div class="line">// 给handler发送一个空消息, 在30秒后执行</div><div class="line">mHandler.sendEmptyMessageAtTime(FLAG_SYNC_DATA, 30 * 1000);</div><div class="line"></div><div class="line">// 给handler发送带有arguments和obj参数的消息, 并在10秒后执行</div><div class="line">Message msg = mHandler.obtainMessage(FLAG_SYNC_DATA, 参数1, 参数2, data);</div><div class="line">mHandler.sendMessageDelayed(msg, 10 * 1000);</div></pre></td></tr></table></figure>
<hr>
<p>在创建<code>Handler</code>的时候构造函数传入<code>Looper</code>对象可以为<code>Handler</code>分配线程, 所以可以创建一个主线程消息的<code>Handler</code>, 避免使用<code>runOnUiThread()</code>这种丑陋缩进的代码并且还低效.</p>
<p>只要确保把消息发送给正确的<code>handler</code>即可.</p>
<h3 id="选择合适的线程"><a href="#选择合适的线程" class="headerlink" title="选择合适的线程"></a>选择合适的线程</h3><p>之前说过了三种在<code>Android</code>上创建和使用线程的方式, <code>API</code>中和线程相关的类还有<code>ExecutorService</code>和<code>Loader</code>.</p>
<ul>
<li><code>ExecutorService</code>适合处理并行运行的多个任务, 这个非常适合编写相应多客户端的服务器应用. <code>AsyncTask</code>内部同样使用了<code>ExecutorService</code>处理多线程</li>
</ul>
<p>三种中尽量少的直接使用<code>Thread</code>类, 大多数情况下推荐使用<code>AsyncTask</code>和<code>Handler</code>类, 具体使用哪一个取决于具体的需求. 如果不是很频繁地执行操作, 比如超过每分钟一次, 那么<code>AsyncTask</code>是个选择的对象. 如果需要安排操作时间或者需要快速间隔地执行操作, <code>Handler</code>是个更好的选择. 从长远的角度来看, <code>Handler</code>生成的代码较少, 而<code>AsyncTask</code>更容易使用.</p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://yoursite.com/2017/09/11/android/books/《Android 编程实战》Chap2_Android上编写高效Java/" data-id="cj7g7uql6000116pjqgp82afq" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    
        <a href="http://yoursite.com/2017/09/11/android/books/《Android 编程实战》Chap2_Android上编写高效Java/#comments" class="article-comment-link">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-android/books/《Android 编程实战》Chap1_完善开发环境和优化" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/09/11/android/books/《Android 编程实战》Chap1_完善开发环境和优化/">《Android 编程实战》Chap1_完善开发环境和优化</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/09/11/android/books/《Android 编程实战》Chap1_完善开发环境和优化/">
            <time datetime="2017-09-11T13:34:19.000Z" itemprop="datePublished">2017-09-11</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/android/">android</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/android/《Android-编程实战》/">《Android 编程实战》</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/android/">android</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <blockquote>
<p>阅读《Android 编程实战》一书的随记笔记<br>注：本文主要参考<a href="http://szysky.com" target="_blank" rel="external">http://szysky.com</a></p>
</blockquote>
<h2 id="Android-SDK-进一步了解"><a href="#Android-SDK-进一步了解" class="headerlink" title="Android SDK 进一步了解"></a>Android SDK 进一步了解</h2><p>SDK基本我们都是确保为最新的. 更新SDK最简单的方法就是命令行:</p>
<p><code>$ android update sdk --no-ui</code></p>
<p>命令脚本在<code>SDK</code>安装目录的<code>tools</code>文件夹下. 对于之后对其例如<code>tools</code>, <code>platform-tools</code>, <code>gradle</code>的全局环境配置就不单独说明. 说一下<code>mac</code>下的配置<code>/Users/yourname/</code>文件夹下的<code>bash_profile</code>文件. 放入一下我的全局配置文件,可以作为格式参考,别忘了替换成你自己的电脑用户名.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">export PATH=&quot;/usr/local/mysql/bin:$PATH&quot;</div><div class="line">#添加mysql的全局开启关闭服务</div><div class="line">export PATH=&quot;/usr/local/mysql/support-files:$PATH&quot; </div><div class="line">  </div><div class="line">export PATH=$&#123;PATH&#125;:/Users/suzeyu/Library/Android/sdk/tools  </div><div class="line"></div><div class="line">export PATH=$&#123;PATH&#125;:/Users/suzeyu/Library/Android/sdk/platform-tools </div><div class="line"></div><div class="line">export ANDROID_HOME=~/Library/Android/sdk</div><div class="line"></div><div class="line"># 设置ndk环境路径</div><div class="line">export PATH=$&#123;PATH&#125;:/Users/suzeyu/Library/Android/sdk/ndk-bundle</div><div class="line"></div><div class="line"></div><div class="line">#THIS MUST BE AT THE END OF THE FILE FOR SDKMAN TO WORK!!!</div><div class="line">export SDKMAN_DIR=&quot;/Users/suzeyu/.sdkman&quot;</div><div class="line">[[ -s &quot;/Users/suzeyu/.sdkman/bin/sdkman-init.sh&quot; ]] &amp;&amp; source &quot;/Users/suzeyu/.sdkman/bin/sdkman-init.sh&quot;</div></pre></td></tr></table></figure>
<p>当配置全局环境完成之后, 可以手动刷新全局环境, 让更改的操作立即生效.</p>
<p><code>$ source ~/.bash_profile</code></p>
<h3 id="adb工具"><a href="#adb工具" class="headerlink" title="adb工具"></a>adb工具</h3><p><code>adb</code>位于<code>platform-tools</code>文件夹. 可以使用<code>$ adb help all</code>查看可执行的操作.</p>
<p>一些常用的命令:</p>
<ul>
<li><code>adb devices</code> 列出所有连接的Android设备和虚拟机</li>
<li><code>adb push &lt;local&gt; &lt;remote&gt;</code> 将电脑上的文件复制到设备</li>
<li><code>adb pull &lt;remote&gt; &lt;local&gt;</code> 将设备上的文件复制到电脑</li>
</ul>
<p><strong>如果存在多台设备,进行操作的时候需要选择某一个设备</strong></p>
<p><img src="http://szysky.com/2016/09/20/%E3%80%8AAndroid-%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98%E3%80%8B%E5%AE%8C%E5%96%84%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%92%8C%E4%BC%98%E5%8C%96/multi_devices.png" alt="img"></p>
<p>通过<code>-s &lt;指定serial number&gt;</code>来确定连接哪一个设备.</p>
<p><strong>adb logcat查看日志</strong></p>
<p><code>$ adb logcat MainActivity:* *:s</code></p>
<p>这条命令会开启日志输出, 并且只打印<code>MainActivity</code>标签的日志. <code>*</code>代表任何可能的值. 其格式<code>&lt;tag&gt;:&lt;priority&gt;</code>, 而后面的<code>*:s</code>添加的特殊过滤用来过滤所有信息. 如果还想显示Android系统相关的日志以及由平台引起的应用程序异常可以加上<code>AndroidRuntime:*</code>参数.</p>
<p><strong>WiFi连接adb</strong></p>
<p>USB连接时最常用, 当不代表就是唯一途径. 也可以用<code>WiFi</code>通过<code>TCP/IP</code>连接来连接设备.</p>
<p>如果想要无线连接, 首先需要使用USB先连接电脑, 进行配置; 并且保证电脑和手机是处在同一<code>WiFi</code>环境下. 这是先决条件. (WiFi ip地址可以在手机设备网络连接查看). 然后命令即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ adb tcpip 5555</div><div class="line">$ adb connect 192.168.1.104</div><div class="line">$ adb devices    #查看当前连接设备, 应该可以看见两个连接</div></pre></td></tr></table></figure>
<p>说明一下,<code>tcpip 5555</code>会在<code>TCP/IP</code>模式下重启adb守护进程, 然后监听5555端口(adb默认端口). <code>connect</code>命令会使用电脑上的adb服务连接设备的IP地址. 然后拔掉usb查看设备应该会出现一个<strong>ip地址:端口</strong>序列名的设备. 你可以使用<code>adb shell</code>简单测试一下.</p>
<p>adb守护进程会一直保持<code>TCP/IP</code>模式, 直到设备重新启动, 或者运行了<code>adb usb</code>, 该命令会重启<code>USB守护进程</code>.</p>
<p>当然有利就有弊, 首先不是所有设备都支持<code>WiFi</code>连接, 并且相比较usb调试. 速度方面明显比较慢.</p>
<p><strong>在Android设备上执行命令</strong></p>
<p>当在<code>Android</code>设备上运行<code>shell</code>时, <code>am</code>和<code>pm</code>命令会比较有用, 他们对应<code>应用程序Application</code>和<code>包管理器Package Manager</code>. 例如由一个外部<code>Intent</code>启动<code>Service</code>可以使用<code>am</code>命令手动发送<code>Intent</code>.</p>
<p><code>$ adb shell am startservice -a &lt;intent action&gt;</code></p>
<p>同时也可以指定某一个具体的组件名. 也可以启动<code>Activity</code>或者发送<code>Intent广播</code>. 例如当开发过程中需要测试一个<code>Service</code>, 但是启动它的<code>Activity</code>还没有被创建, 这时候就可以使用命令.</p>
<p><code>包管理器</code>是<code>Android</code>上的一个核心组件. 它用来管理设备上已安装的应用程序. 可以像使用<code>Application Manager</code>一样控制pm命令来使用. 比如允许开发者查看, 安装, 卸载已安装程序等. 还能检查这些应用的特性和应用权限. 例如:</p>
<p>查看已安装的程序</p>
<p><code>$ adb shell pm list packages</code></p>
<p>如果需要查看更多使用说明可以看官网说明<a href="https://developer.android.com/studio/command-line/adb.html" target="_blank" rel="external">adb使用说明</a> 注意科学上网…</p>
<h3 id="Gradle简单说明"><a href="#Gradle简单说明" class="headerlink" title="Gradle简单说明"></a>Gradle简单说明</h3><p>随着AS的普及, 对于<code>Gradle</code>也将彻底替代<code>Ant</code>脚本. 和<code>Ivy</code>,<code>Maven</code>一样的模块化构建系统. 他结合了<code>Ant</code>的灵活以及<code>Maven</code>中的依赖管理. <code>Gradle</code>使用了<code>Groovy</code>领域的专用语言, 可以更清楚地描述配置项, 不用再写复杂的XML构建脚本.</p>
<p>关于根目录的<code>build.gradle</code>文件. 中主要有三个区块:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">apply plugin: xxx       // gradle应用哪种插件</div><div class="line"></div><div class="line">buildscript&#123;    // 告诉gradle使用哪个仓库去下载构建所用的插件以及依赖</div><div class="line">    ...</div><div class="line">&#125;</div><div class="line"></div><div class="line">dependencies&#123;   // 项目的依赖</div><div class="line">    ...</div><div class="line">&#125;</div><div class="line"></div><div class="line">android&#123;        // 项目的配置项</div><div class="line">    ..</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>虽然可以直接在<code>AS</code>中构建项目, 同样也可以通过命令与构建系统交互. <code>Gradle</code>定义了一系列任务. 在项目根目录下输入如下命令即可列出可用的任务:</p>
<p><code>$ ./gradlew tasks</code></p>
<p>如果需要从头开始构建一个应用程序, 只需要运行下面的命令:</p>
<p><code>$ ./gradlew clean build</code></p>
<h3 id="ProGuard优化和混淆代码好处"><a href="#ProGuard优化和混淆代码好处" class="headerlink" title="ProGuard优化和混淆代码好处"></a>ProGuard优化和混淆代码好处</h3><ol>
<li>对代码混淆可以让反编译更加困难.</li>
<li>删除无用的代码能压缩生成更小的二进制dex文件</li>
<li>并且由于对方法名,成员变量等混淆可以提高相应的运行速度</li>
</ol>
<p>由于<code>ProGuard</code>工具对Android代码进行了混淆, <code>Gradle</code>构建工具也支持该工具, 可在<code>build.gradle</code>文件的<code>android块-&gt;buildTypes块-&gt;</code>添加对应代码.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">buildTypes &#123;</div><div class="line">   debug &#123;</div><div class="line">   &#125;</div><div class="line">   release &#123;</div><div class="line">       //混淆开关</div><div class="line">       minifyEnabled true</div><div class="line">      </div><div class="line">       //加载默认混淆配置文件 progudard-android.txt在sdk目录里面，不用管，proguard.cfg是我们自己配的混淆文件</div><div class="line">       proguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguard-rules.pro&apos;</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="熟悉IDE"><a href="#熟悉IDE" class="headerlink" title="熟悉IDE"></a>熟悉IDE</h2><h3 id="断点"><a href="#断点" class="headerlink" title="断点"></a>断点</h3><p>当程序达到断点出, 可以检查此时的应用状态. 所有的作用域中的变量都会直接显示IDE的调试视图中. 并且可以改变当前作用域的变量值, 可不需要重启应用.</p>
<p>根据单步的不同跳入方法, 可以<strong>顺序执行</strong>, <strong>自己定义的方法跳入</strong>, <strong>系统提供的方法跳入</strong>, 鼠<strong>标垫跳入</strong>.等可以追踪到不容易发现的问题.</p>
<h3 id="lint静态代码分析"><a href="#lint静态代码分析" class="headerlink" title="lint静态代码分析"></a>lint静态代码分析</h3><p>编写代码总会伴随着错误发生, 即使经验丰富的人也不过是把错误发生的概率降低. 但是不能杜绝. 针对这种问题就出现了编写单元测试来检测方法代码. 但是编写的单元测试也不可能覆盖所有的情况. 所以有时候可能需要其他的方式来检测. 例如<strong>静态代码分析</strong></p>
<p><strong>功能:</strong></p>
<p><code>lint</code>工具会检查性项目中的源文件, 包括<code>XML</code>和<code>Java</code>. 它还会查找缺失元素,结构不良的代码,问呗使用的变量等. 在<code>AS</code>中高亮显示的代码表示代码要修正. 可以将鼠标移动到此处会显示更多细节.</p>
<p><strong>问题:</strong></p>
<p>虽然<code>lint</code>可以很强大的检测一些错误, 但有时候可能我们并不想让其显示警告, 例如如果缺少了推荐代码, 由于某些原因使用了过时代码, 但是毫无办法并且确认程序是不会发生错误的, 这个时候是就可以压制<code>lint</code>的警告.</p>
<ul>
<li><code>java文件</code>: 可以使用<code>@SuppressLint</code>注解, 把需要一直的警告当做参数</li>
<li><code>xml文件</code>: 需要引入<code>lint</code>命名空间(<code>xmlns:tools=&quot;http://scheme.android.com/tools&quot;</code>), 然后在需要抑制警告的时候添加<code>tools:ignore=&quot;WarningName&quot;</code></li>
</ul>
<h3 id="重构代码"><a href="#重构代码" class="headerlink" title="重构代码"></a>重构代码</h3><p><code>IDE</code>内置了多种重构任务. 重构涉及<strong>命名</strong>, <strong>移动变量,方法,类</strong>, <strong>修改方法签名</strong>, <strong>封装字段</strong>等等. 在<code>AS</code>中将光标放在需要修改的代码处, 然后从<code>Refactor</code>菜单中进行后续具体的操作</p>
<ol>
<li><strong>提取常量</strong>: (<code>Extract Constant</code>). 可以快速的将一个变量替换成常量.</li>
<li><strong>修改方法签名</strong>: 方法签名定义了方法的修饰符, 返回类型, 名称, 参数.</li>
<li><strong>从代码提取方法</strong>: 保持方法的内容不要过多, 并且方法的目的明确.这是一种好的习惯. 可以选中一段代码块然后执行<code>Extract Method</code>(抽取方法)来提取出一段代码重构为一个方法. 此后如果有需要还可以修改方法签名(<code>Change Method Signature</code>)来进行处理.</li>
<li>…</li>
</ol>
<p>更多的选项可以自己去手动实践. 当熟练之后, 对于代码编写速度是一个不错的提升.</p>
<h2 id="手机上的开发者选项"><a href="#手机上的开发者选项" class="headerlink" title="手机上的开发者选项"></a>手机上的开发者选项</h2><p>这里稍微介绍一下关于开发者选项里面的一些功能.</p>
<ul>
<li><strong>不锁定屏幕(Stay Awake)</strong>: 该选项可以在设备充电的时防止屏幕锁屏, 前提是用USB线和电脑连接. 这样就不需要由于等待时间过长, 手机自动锁屏.</li>
<li><strong>启动USB调试</strong>: 这是使用<code>adb</code>连接设备和开发环境的先决条件.</li>
<li><strong>Allow Mock Location</strong>: 如果需要对位置相关开发, 可以使用此模式模拟(不同厂商可能不提供)</li>
<li><strong>显示触摸操作(Shoe Touches)和指针位置(Pointer Location)</strong>: 它们对编写需要手势或者多点触控界面等高级触摸开发调试比较有用处</li>
<li><strong>Drawing(绘图)</strong>: 可以让开发者获取视图反馈的设置项, 比如用户界面布局以及重绘的速度和频率. 可以为动画和过渡效果设置缩放参数. 也可以在调试的时候完全禁用他们. <code>Android4.2</code>中的一个新功能是允许模拟辅助显示屏.</li>
<li><strong>Monitoring(监控)</strong>: 有些设置项对确保设备流畅运行非常有用. 大部分开发者通常使用的测试机为新款手机. 但是有些用户的的一些旧设备可能会出现一些高端机上不会发生的问题. 使用以下这些选项可以更早的定位这些问题.</li>
<li><ul>
<li><code>Strict Mode Enabled(严格检查模式)</code>: 在主线程执行一个很耗时的操作时设配屏幕会闪烁.</li>
</ul>
</li>
<li><ul>
<li><code>Show CPU Usage(显示CPU使用情况)</code>: 性能比较, 可以跟踪程序的CPU使用率</li>
</ul>
</li>
<li><strong>Apps部分</strong>: 也可以作为模拟使用较差的CPU和低内存的设备行为.</li>
<li><ul>
<li><code>不保留活动(Don&#39;t keep Activities)</code>: 可确保每次启动<code>Activity</code>都重新创建. <strong>默认</strong>是只有内存不足的时候才会删除, 并且做到尽量保持<code>activity</code>处于活动状态.</li>
</ul>
</li>
<li><ul>
<li><code>后台进行限制(Background Process Limit)</code>: 可以更早的结束后台操作,和上面选项模拟的行为类似.</li>
</ul>
</li>
<li><ul>
<li><code>显示所有ANR(Show All ANRs)</code>: 当应用程序在后台崩溃时他会变得更加明显. 通常, 只有当前在前台运行的应用程序才会显示<code>ANR</code></li>
</ul>
</li>
</ul>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://yoursite.com/2017/09/11/android/books/《Android 编程实战》Chap1_完善开发环境和优化/" data-id="cj7g7uql1000016pjm0ap5y8d" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    
        <a href="http://yoursite.com/2017/09/11/android/books/《Android 编程实战》Chap1_完善开发环境和优化/#comments" class="article-comment-link">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-mysql/mysql_4 数据控制语言控制" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/09/08/mysql/mysql_4 数据控制语言控制/">mysql_4 数据控制语言控制</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/09/08/mysql/mysql_4 数据控制语言控制/">
            <time datetime="2017-09-08T09:10:54.000Z" itemprop="datePublished">2017-09-08</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/mysql/">mysql</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/mysql/">mysql</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <blockquote>
<p>注：本文主要参考<a href="http://szysky.com" target="_blank" rel="external">http://szysky.com</a></p>
</blockquote>
<h3 id="数据控制语言-DCL-Data-Control-Language"><a href="#数据控制语言-DCL-Data-Control-Language" class="headerlink" title="数据控制语言 DCL (Data Control Language)"></a>数据控制语言 DCL (Data Control Language)</h3><p>数据控制语言,是用于对<code>mysql</code>的用户及其权限进行管理的语句.</p>
<p><strong>用户管理</strong></p>
<p>mysql中的所有用户,都存在系统数据库(mysql)中的 <code>user</code> 表中–不敢那个数据库的用户,都存储在这里.<code>(服务器: localhost--&gt;数据库: mysql--&gt; 表 user)</code></p>
<p><strong>创建用户</strong></p>
<p>形式: <code>create user &#39;用户名&#39;@&#39;允许登录的地址/服务器&#39; identified by &#39;密码&#39;</code></p>
<p>如果想创建一个指定的 <code>ip</code> 用户想访问我们本地的数据库这样</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">create user &apos;extra&apos;@&apos;192.168.x.x&apos; identified by &apos;123&apos;;    //这样就创建了一个 extra 的用户  对方访问可以这样&lt;br/&gt;</div><div class="line">mysql -h我的主机名 -uextra -p;</div></pre></td></tr></table></figure>
<p><strong>删除用户</strong></p>
<p><code>drop user &#39;用户名&#39;@&#39;允许登录的地址或服务器&#39;</code></p>
<p><strong>修改用户密码</strong></p>
<p><code>set password = password(&#39;密码&#39;);</code></p>
<p><code>setpassword for &#39;用户名&#39;@&#39;允许登录的地址&#39; = password(&#39;密码&#39;);</code></p>
<h3 id="权限管理"><a href="#权限管理" class="headerlink" title="权限管理"></a>权限管理</h3><p><code>mysql</code> 数据库,将其中所能做的所有事情否分门别类分配到大约30多个权限中去了,其中每个权限,都是一个单词而已.</p>
<ul>
<li><code>select</code>: 代表可以查询数据;</li>
<li><code>update</code>: 代表可以修改数据;</li>
<li><code>delete</code>: 代表可以删除数据;</li>
<li>……</li>
</ul>
<p>其中有一个特别的权限 : <code>all</code> 设置出 <code>GRANT OPTION</code> 之外的所有简单权限.</p>
<p><strong>授予权限</strong></p>
<p>形式:</p>
<ul>
<li><code>grant 权限列表 on 某库.某对象 to &#39;用户名&#39;@&#39;允许登录的位置&#39; [identified by &#39;密码&#39;];</code></li>
</ul>
<p>说明:</p>
<ol>
<li>权限列表,就是多个权限的名字,相互之间用逗号分开,比如: <code>select,insert,update</code>, 也可以写 <code>all</code></li>
<li><code>某库.某对象</code>,表示给指定的某个数据库中的某个下级单位附权,下级单位有: 表名,视图名,存储过程名,存储函数名.其中可以使用统配语法–&gt;</li>
<li><code>\*.\*</code>: 代表所有的数据库的所有下级单位.</li>
<li>某库.*: 代表指定的该库中的所有下级单位</li>
</ol>
<p><strong>剥夺权限</strong></p>
<p>形式:</p>
<ul>
<li><code>revoke 权限列表 on 某库.某个对象 from &#39;用户名&#39;@&#39;允许登录的位置&#39;</code></li>
<li>其含义,跟 <code>grant</code> 完全一样;</li>
</ul>
<h3 id="数据事务语言-DDL-Data-Transaction-Language"><a href="#数据事务语言-DDL-Data-Transaction-Language" class="headerlink" title="数据事务语言 DDL (Data Transaction Language)"></a>数据事务语言 DDL (Data Transaction Language)</h3><p>就是用来保证多条增删改语句的执行的一致性,要么都执行,要么都没有执行.</p>
<p><strong>事务的特点</strong></p>
<ul>
<li>原子性: 一个事务总的所有语句,应该做到要么全做,要么一个都不做.</li>
<li>一致性: 让数据保持逻辑上的合理性,例如一个商品出库时,既要让商品库数量减1,又让让对应用户购物车商品加1.</li>
<li>隔离性: 如果多个事务同时并发执行,但每个事务就像各自独立执行一样.</li>
<li>持久性: 一个事务执行成功,则对数据来说应该死一个明确的硬盘数据更改,而不仅仅是内存中的变化.</li>
</ul>
<p><strong>事务模式</strong></p>
<p>在我们 <code>cmd</code> 命令模式中,是否开启了 一条语句就是一个事务 的这个开关.<br>默认情况下(安装后) ,这个模式是开启的,称为自动提交模式;我们可以手动把他关闭,那就是’非自动提交模式’</p>
<p><code>set autocommit = 0/false</code> //关闭该模式</p>
<p><strong>事务执行的基本流程</strong></p>
<ol>
<li><p>开启一个事务: <code>start transaction;</code> //也可以写成: <code>begin</code></p>
</li>
<li><p>执行多条增删改语句; //也就是相当于希望这多条语句作为一个不可分割的整体去执行.</p>
</li>
<li><p>判断这些语句执行的结果:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">if(没有出错)&#123;</div><div class="line">    commit;        //提交事务;此时就是一次性完成;</div><div class="line">&#125; else&#123;</div><div class="line">    roolback;    //回滚事务;此时什么都没有做;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="mysql-编程"><a href="#mysql-编程" class="headerlink" title="mysql 编程"></a>mysql 编程</h3><p><strong>mysql 编程中语句块包含符</strong></p>
<p>就是相当于 <code>js</code> 或 <code>php</code> 中的大括号语法:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[标识符 :] begin</div><div class="line">    //语句...</div><div class="line">end;[标识符];</div></pre></td></tr></table></figure>
<p>标识符就是定义任意的名字而已,比如:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">if(条件判断)    </div><div class="line">    begin</div><div class="line">        //.....</div><div class="line">    end;</div><div class="line">end if;</div><div class="line"></div><div class="line">if(条件判断)</div><div class="line">    A:begin</div><div class="line">        //...</div><div class="line">    end A;</div><div class="line">end if;</div><div class="line">A 就是标识符,它的租用是标识该语句块,以期可以在该语句块中使用它--其实就是退出.</div></pre></td></tr></table></figure>
<p><strong>流程控制语句</strong></p>
<p>1.<code>if</code> 语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">if 条件语句 then</div><div class="line">    begin</div><div class="line">        语句块</div><div class="line">    end;</div><div class="line"></div><div class="line">    elseif 条件语句 then </div><div class="line">    begin</div><div class="line">        语句块</div><div class="line">    end;</div><div class="line"></div><div class="line">    else</div><div class="line">    begin</div><div class="line">        else 语句块</div><div class="line">    end;</div><div class="line">end if;</div></pre></td></tr></table></figure>
<p>2.<code>case</code> 语句 相当于 <code>java</code> 的 <code>switch</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">CASE case_value</div><div class="line"></div><div class="line">    WHEN when_value THEN statement_list</div><div class="line"></div><div class="line">    WHEN when_value1 THEN statement_list    //可以有很多 when 和 then 组合</div><div class="line">    ELSE statement_list</div><div class="line"></div><div class="line">END CASE</div></pre></td></tr></table></figure>
<p>语法 <code>case @v1 ... end case; //@v1表示一个变量;后面都这样</code></p>
<p><strong>3.loop 循环语句</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">标识符: loop</div><div class="line">begin</div><div class="line">    //这里就是循环的语句块</div><div class="line">    //注意这里必须要有一个退出循环的逻辑机制,否则该循环就是死循环,其基本形式类似这样</div><div class="line">        if(条件) then</div><div class="line">            leave 标识符;    //退出</div><div class="line">        end if;</div><div class="line">end;</div><div class="line">end loop 标识符;</div></pre></td></tr></table></figure>
<p><strong>4.while循环语句</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">set @v1&lt;10 do</div><div class="line">    begin</div><div class="line">        insert into tab1 (id,num) values(null, @v1);</div><div class="line">        set @v1 = @v1 + 1;</div><div class="line">    end;</div><div class="line">end while;</div></pre></td></tr></table></figure>
<p><strong>5.repeat语句</strong><br>类似于<code>dowhile</code>语句,但是这里条件为真就不执行,为假就继续执行.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">set @v1 = 1;    //赋值语句</div><div class="line">repeat</div><div class="line">    begin</div><div class="line">        insert into tab1 (id,num) values(null,@v1);</div><div class="line">        set @v1 = @v1+1;</div><div class="line">    end;</div><div class="line">    until @v1 &gt;= 9;</div><div class="line">end repeat;</div></pre></td></tr></table></figure>
<p><strong>leave语句</strong></p>
<p>语法: <code>leave</code> 标识符;</p>
<p>作用: 用来退出<code>begin...end</code>结构或其他具有标识符的结构.</p>
<p><strong>mysql中的变量</strong></p>
<p><code>mysql</code>中,有两种变量形式:</p>
<ul>
<li>普通变量: 不带 <code>@</code> 符号</li>
</ul>
<p>形式: <code>declare 变量名 类型名 [default 默认值]; //普通变量必须先这样定义</code></p>
<p>使用场景:只能在编程环境使用,有3个:1函数内部,存储过程内部,触发器的内部.</p>
<ul>
<li>会话变量: 带 <code>@</code> 符号</li>
</ul>
<p>形式: <code>set @变量名 = 值; //跟php类似,无需定义,直接赋值,第一次就算是定义</code></p>
<p>使用场景: 任何场景.</p>
<p><strong>变量赋值</strong></p>
<ol>
<li><code>set 变量名 = 表达式;</code> #此语法中的变量必须先使用declare声明.</li>
<li><code>set @变量名 = 表达式;</code> #此方式可以无需<code>declare</code>语法声明,而是直接赋值,类似<code>php</code>定义变量并赋值.</li>
<li><code>select @变量名:=表达式;</code> #此语句会给该变量赋值,同时还会作为一个<code>select</code>语句输出结果集.</li>
<li><code>select 表达式 into @变量名;</code>#此语句虽然看起来是<code>select</code>语句,但其实并不输出结果集,而只是给变量赋值.</li>
</ol>
<p><strong>(存储)函数</strong></p>
<p>函数,也说成存储函数,其实就是<code>js</code>和<code>php</code>中所说的函数.</p>
<p>注意:</p>
<ol>
<li>在函数内部,可以有各种变量和流程控制的的使用.</li>
<li>在函数内部,也可以有各种增删改语句.</li>
<li>在函数内部,不可以用<code>select</code>或其他返回结果集的查询类语句.</li>
</ol>
<p>唯一的区别:</p>
<ul>
<li>这里的函数必须返回一个数据(值);</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">//创建一个函数</div><div class="line">create function getMaxValue(p1 float, p2 float, p3 float)</div><div class="line">returns float;    #返回float类型</div><div class="line">begin</div><div class="line">    .... # 要执行的内容</div><div class="line">end;</div></pre></td></tr></table></figure>
<p>上处代码直接在命令行执行可能会有error,因为代码中包含; 会提前结束没有完成的语句.解决方案可以通过修改’语句结束符’. <code>delimiter ///</code></p>
<p><strong>删除函数</strong></p>
<p><code>drop function</code></p>
<h3 id="存储过程"><a href="#存储过程" class="headerlink" title="存储过程"></a>存储过程</h3><p>存储过程,其实还是函数 – 但其规定: 不能有返回值.</p>
<p>创建一个存储过程</p>
<p>效果目标: 将3个数据写入到表<code>tab_int</code></p>
<p>并返回该表的第一个字段的前3大值得行.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">create procedure insert_get_date(p1 int, p2 tinyint, p3 bigint)</div><div class="line">begin</div><div class="line">    insert into tab_int(f1,f2,f3) values(p1,p2,p3);</div><div class="line">    select * from tab_int order by table_int.f1 desc limit 0,3;</div><div class="line">end;</div></pre></td></tr></table></figure>
<p>调用存储过程:</p>
<ul>
<li><code>call</code> 存储过程名(实参1, 实参2, …)</li>
<li>它应该是在非编程环境中调用,既执行增删改查的场景.</li>
</ul>
<p><strong>删除存储过程</strong></p>
<p><code>drop procedure 存储过程名;</code></p>
<h3 id="触发器-trigger"><a href="#触发器-trigger" class="headerlink" title="触发器 trigger"></a>触发器 trigger</h3><p>触发器,也是一段预先定义好的编程代码(跟存储过程和存储函数一样),并有个名字.</p>
<p>它不能调用,而是,在某个表发生某个事件(增,删,改)的时候,会自动触发而调用起来.</p>
<p>定义形式:</p>
<ul>
<li><code>create trigger 触发器名 触发时机 触发事件 on 表名 for each row</code></li>
</ul>
<p>begin //…. end;</p>
<p>说明:</p>
<ol>
<li>触发时机,只有两个: <code>before</code>(在…之前), <code>after</code>(在…之后);</li>
<li>触发事件,只有三个: <code>insert</code>, <code>update</code>, <code>delete</code></li>
<li>既触发器的含义是: 在某个表上进行<code>insert</code>(或<code>update</code>或<code>delete</code>)之前,或之后.</li>
<li>通常,触发器用于在对某个表进行增删改的操作的时候,需要同时去做另外一件事的时候;</li>
<li>在触发器的内部,有两个关键字代表某种特定的含义,可以用来获取数据<br><code>new</code>:它代表当前正要执行的<code>insert</code>或<code>update</code>的时候’新行’数据;通过他,可以获取这一新行数据的任意一个字段形式为: <code>set @v1 = new.id;</code> //获得该新插入或update行的id的值(前提是有该id).</li>
<li><code>old</code>:它代表当前正要执行的delete的时候’旧行’数据;通过他,可以获取这一旧行数据的任意一个字段形式为: <code>set @v1 = new.id;</code> //获得该新插入或<code>update</code>行的<code>id</code>的值(前提是有该id).</li>
</ol>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://yoursite.com/2017/09/08/mysql/mysql_4 数据控制语言控制/" data-id="cj7bo43qz0001v5pjyl3gnqwh" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    
        <a href="http://yoursite.com/2017/09/08/mysql/mysql_4 数据控制语言控制/#comments" class="article-comment-link">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-mysql/mysql_3 子查询" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/09/08/mysql/mysql_3 子查询/">mysql_3 子查询</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/09/08/mysql/mysql_3 子查询/">
            <time datetime="2017-09-08T09:10:17.000Z" itemprop="datePublished">2017-09-08</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/mysql/">mysql</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/mysql/">mysql</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <blockquote>
<p>注：本文主要参考<a href="http://szysky.com" target="_blank" rel="external">http://szysky.com</a></p>
</blockquote>
<h3 id="连接查询"><a href="#连接查询" class="headerlink" title="连接查询"></a>连接查询</h3><p>概念: 就是将两个或两个以上的表，连接起来，当做一个数据源，并从中去取得所需要的数据。</p>
<p>就是将每一个表的每一行数据两两之间相互对接起来，每次对接的结果都是连接结果的 一行 数据。</p>
<p>没有条件的连接写法:</p>
<ul>
<li><code>select * from 表1, 表2;</code></li>
<li><code>select * from 表1 join 表2;</code></li>
<li><code>select * from 表1 cross join 表2;</code></li>
</ul>
<p><strong>连接基本形式</strong></p>
<p>在代码级别，连接的基本形式为:</p>
<ul>
<li><code>表1 [连接形式] join 表2 [on 连接条件];</code></li>
</ul>
<p>如果是3个表，则进一步扩展为:</p>
<ul>
<li><code>表1 [连接形式] join 表2 [on 连接条件] [连接形式] join 表3 [on 连接条件]</code></li>
</ul>
<p><strong>连接的分类</strong></p>
<p>交叉连接</p>
<ul>
<li>其实就是上面的连接形式，–因为没有条件，只是按连接的基本概念，将所有数据行都连接起来的结果。它又叫做‘笛卡尔积’。</li>
<li>对于表1 和表2 的连接，交叉结果是: 行数=两个表字段之和； 列数=两个表的乘积数</li>
</ul>
<p><strong>内连接</strong></p>
<ul>
<li><code>形式: select * from 表1 [inner] join 表2 on 连接条件。</code></li>
</ul>
<p>例如有 <code>student</code>表和 <code>type</code>表 学生表中包含科目<code>pro_id</code>, 而<code>Type</code>表有每个<code>pro_id</code>字段并对应说明。这时候如果需要类连接查询如下：</p>
<p><code>select * from student inner join type on student.pro_id = type.pro_id;</code></p>
<p>优化: <code>SELECT o.* ,t.sex FROM db1.join1 as o inner join db1.join2 as t on o.type = t.type;</code></p>
<p>注意: 这种的表和表之间的内连接传，虽然可以提现为表跟表之间的关系– 一般情况下这就是外键的关系，单并不是有外键关系才可以使用。</p>
<p><strong>左(外)连接 left(outer) join</strong></p>
<ul>
<li>形式: <code>表1(左表) left [outer] join 表2(右表) on 连接条件</code></li>
<li>含义: 就是将两个表的内连接的结果，再加上左边表不符合内连接所设定的条件的那些数据结果。</li>
<li><code>SELECT o.* ,t.sex FROM db1.join1 as o left join db1.join2 as t on o.type = t.type;</code></li>
</ul>
<p><strong>右(外)连接 right(outer) join</strong></p>
<p>同左连接–只不过关键字为right(outer)</p>
<p><strong>全连接 full(outer) join</strong></p>
<p>在<code>mysql</code>中不支持全连接的语法;</p>
<p>含义: 将两个表内连接的结果，加上左边不符合的结果，和右边不符合的结果。</p>
<h3 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h3><p>含义: 一个<code>select</code>语句，就是一个查询语句</p>
<ul>
<li><code>select 字段或表达式 from 数据源 where xx条件判断；</code></li>
</ul>
<p>上述<code>select</code>部分，<code>from</code>部分，<code>where</code>部分，往往都是一些数据 或者数据的集合。</p>
<p><code>from</code>部分, 当然就是 表 ，或 表的连接结果，他们也是数据，只是通常为表数据。</p>
<p>例子 <code>select pro_id, price from product where price &gt; (select avg(price) from product)</code></p>
<p>例子的<code>where</code>后面括号中的<code>select</code>语句就是子查询。</p>
<p>所以可以认为就是在一个查询语句的内部，某些位置，又出现了查询语句。 由此引出了主查询和子查询的概念。</p>
<p>通常，子查询是为主查询服务的，所以子查询获得一定的结果数据之后，才去执行主查询。</p>
<p>形式: <code>select 字段或表达式或子查询 [as 别名] from 表名或链接结果或子查询 where 字段或表达式或子查询的条件判断。</code></p>
<p><strong>按子查询结果，可分为如下几个</strong></p>
<ul>
<li>表 子查询</li>
</ul>
<p>一个子查询返回的结果理论上是多行多列的时候，此时可以当做一个表来使用，通常是放在<code>from</code>后面。</p>
<ul>
<li>行 子查询</li>
</ul>
<p>一个子查询返回的结果理论是一行多列的时候。此时可以当做一个行来使用，通常放在行比较语法上。<br>行比较语法类似这样: <code>where row(字段1,字段2) = (select 行子查询)</code>;</p>
<ul>
<li>列 子查询</li>
</ul>
<p>一个子查询返回的结果理论上是多行一列的时候，此时可以当做多个值来使用。<br>类似(5,8,10,11).</p>
<ul>
<li>标量 子查询</li>
</ul>
<p>一个子查询返回的结果理论上是一行一列的时候，此时可以当做一个单个值使用，类似这种: <code>select 5 as c1; 或select ... where id = 17, 或select ... where b&gt;8;</code></p>
<p><strong>子查询，按位置(场合)分</strong></p>
<ul>
<li>作为主查询的结果数据</li>
<li>作为主查询的条件数据</li>
<li>作为主查询的来源数据</li>
</ul>
<p><strong>常见子查询</strong></p>
<p><strong>比较运算符总的子查询</strong></p>
<p>形式: 操作数 比较运算符 (标量子查询)</p>
<p>说明: 操作数，其实就是比较运算符的2个数据之一而已，通常就是一个字段名。</p>
<p>举例:</p>
<p>找出最高价的商品:</p>
<ul>
<li><code>select * from product where price = (select max(price) from product);</code></li>
</ul>
<p><strong>使用in的子查询</strong></p>
<p>以前的in的用法:</p>
<ul>
<li><code>xx in (值1, 值2, 值3, ...);</code></li>
</ul>
<p>in的子查询为:</p>
<ul>
<li><code>xx in (列子查询)</code></li>
</ul>
<p>举例: 找出所有列别名称中带电这个字的所有商品。</p>
<p>可以分两步思考:</p>
<p><code>select protype_id from product_type where protype_name like %电%;</code></p>
<p>为子查询条件 — 以下为主程序 嵌入where其中。</p>
<p><code>select * product where protype_id in(&#39;此处为上一步&#39;);</code></p>
<p><strong>使用any的子查询</strong></p>
<p>形式: 操作数 比较运算符 <code>any</code> (列子查询);</p>
<p>含义: 当某个操作数(字段) 对于该列子查询的任意一个值，只要有一个满足该比较运算符，则就算是满足了条件。</p>
<p><strong>使用all的子查询</strong></p>
<p>形式: 操作数 比较运算符 <code>all</code> (列子查询);</p>
<p>含义: 当某个操作数(字段) 对于该列子查询的任意一个值，必须全部满足该比较运算符，则就算是满足了条件。</p>
<p>列子查询 子查询只能是一个字段。</p>
<p>举例: 查询出所有非最高价的商品</p>
<ol>
<li>查询所有的价格 <code>select price form product;</code></li>
<li>在所有的价格中只有最高价会不满足 <code>&lt;any</code>(全部价格)，所以可以这样</li>
</ol>
<ul>
<li><code>select * from product where price &lt; any(select price from product);</code></li>
</ul>
<p>同理: 求出最高价的商品价格，特征： 大于所有的价格</p>
<ul>
<li><code>select * from product where price &gt;= all(select price from produc);</code></li>
</ul>
<p><strong>使用some的子查询</strong></p>
<p>一句话: <code>some</code>是<code>any</code>的同义词。</p>
<p><strong>使用exists的查询</strong></p>
<p>形式: <code>where exists (子查询)</code></p>
<p>含义: 该子查询如果有数据，则<code>exists</code>的结果是<code>true</code>，否则就是<code>false</code>。</p>
<p>在实际应用中，该子查询往往都不是独立的子查询，而是会需要跟主查询的数据源(表),建立牟宗关系—通常就是连接关系。建立的方式是”隐式的”，既没有在代码上体现关系，单却在内部有其连接的 实质 。</p>
<p>此隐式方式，通常就体现在查询中的where条件语句中，使用了主查询表中的数据(字段)，</p>
<p>问题: 查询商品表中其类别名称中带”电”这个字的所有商品。</p>
<p><code>select * from product where exists(select * from product_type where protype_name like &#39;%电%&#39; and protype_id = product.protype_id);</code></p>
<p>注意:</p>
<ol>
<li>这种子查询语句，没法独立存在或者独立运行的，而是必须跟主查询一起使用。</li>
<li>其他子查询，是可以独立运行的，而且会得到一个运行结果。</li>
<li>盖子查询中的条件，应该设定为跟主查询的某个字段有一定的关联性判断。筒仓该判断就是这两个表的 本来该有的脸连接条件。</li>
</ol>
<h3 id="联合查询union"><a href="#联合查询union" class="headerlink" title="联合查询union"></a>联合查询union</h3><p>提示:</p>
<p>在<code>mysql</code>的手册中，将连接查询(<code>join</code>) 翻译为联合查询。而联合查询(<code>union</code>),没有明确翻译。</p>
<p>在通常的书籍或文章，<code>join</code>被翻译为连接查询；而<code>union</code>才被翻译为联合查询。</p>
<p><strong>基本概念</strong></p>
<p>将两个具有相同字段数量的查询语句的结果，以 上下堆叠 的方式，合并为一个查询结果</p>
<p>形式: <code>select 语句1 union [all | distinct] select 语句2;</code></p>
<p>此联合查询语句，默认会”自动消除重复行” ，既默认是<code>distinct</code>。 如果想要将所有数据都显示(允许重复行),就是用<code>all</code>。</p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://yoursite.com/2017/09/08/mysql/mysql_3 子查询/" data-id="cj7bo43r90006v5pjp48ekdbd" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    
        <a href="http://yoursite.com/2017/09/08/mysql/mysql_3 子查询/#comments" class="article-comment-link">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-mysql/mysql_2 基本查询语句" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/09/08/mysql/mysql_2 基本查询语句/">mysql_2 基本查询语句</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/09/08/mysql/mysql_2 基本查询语句/">
            <time datetime="2017-09-08T09:09:49.000Z" itemprop="datePublished">2017-09-08</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/mysql/">mysql</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/mysql/">mysql</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <blockquote>
<p>注：本文主要参考<a href="http://szysky.com" target="_blank" rel="external">http://szysky.com</a></p>
</blockquote>
<h3 id="数据库表设计3范式"><a href="#数据库表设计3范式" class="headerlink" title="数据库表设计3范式"></a>数据库表设计3范式</h3><p><strong>第一范式(1NF)</strong></p>
<p>要求数据达到原子性，是数据不可再分</p>
<p><strong>第二范式(2NF)</strong></p>
<p>使每一行数据具有唯一性，并消除数据之间的部分依赖</p>
<ol>
<li>每一行数据具有唯一性: 只要给表设计主键，就可以保证唯一性</li>
<li>消除数据之间的”部分依赖”</li>
</ol>
<p>依赖的概念</p>
<p>就是在一个表中，其中某个字段的值B可以由另一个字段的值A来决定，则此时我们就称为：字段B依赖于字段A,或者字段A决定字段B。</p>
<p>就是根据字段A的某个值，一定可以找出一个确定的字段B的值，就是A决定B.</p>
<p>部分依赖？</p>
<p>如果某个字段，值依赖于部分主键字段，此时就称为部分依赖。–发生此情况的前提一定是: 主键字段有多个。</p>
<p>完全依赖？<br>某个字段，是依赖于主键的所有字段。– 如果一个表的主键只有一个字段，则此时必然是完全依赖。</p>
<p><strong>第三范式(3NF)</strong></p>
<p>独立性，消除传递依赖。</p>
<p>使每个字段都独立地依赖于主键字段(独立性),而要消除其中部分非主键字段的内部依赖–这种内部依赖会构成传递依赖</p>
<h3 id="数据操作语言-DML"><a href="#数据操作语言-DML" class="headerlink" title="数据操作语言 DML"></a>数据操作语言 DML</h3><p><strong>插入数据(增)</strong></p>
<ul>
<li>形式1: <code>insert [into] 表名 [(字段名1，字段名2...)] values(值表达式1，值表达式2,...),(),()...;</code></li>
<li><ul>
<li>这是最常用的插入语句，可以一次性插入多行数据，用逗号隔开；</li>
</ul>
</li>
<li><ul>
<li>插入语句，要理解为每次插入数据都是以行为单位进行插入；</li>
</ul>
</li>
<li><ul>
<li>字段名通常不推荐省略，其后续的值列表应该字段列表一一对应</li>
</ul>
</li>
<li><ul>
<li>其中的值表达式，可以是一个直接或函数调用结果，或变量值; 其中，如果对应字段是字符或时间类型，则直接值应该使用单引号</li>
</ul>
</li>
<li>形式2: <code>replace [into] 表名 [(字段名1，字段名2...)] values(值表达式1，值表达式2,...),(),()...;</code></li>
<li><ul>
<li>其跟<code>insert into</code>几乎一样: 唯一区别 如果插入的数据的主键或唯一键有重复，则此时就会变成修改改行数据</li>
</ul>
</li>
<li>形式3: <code>insert [into] 表名 [(字段名1，字段名2，...)] select 字段名1，字段名2,... from 其他表名;</code></li>
<li>形式4: <code>insert [into] 表名 set 字段名1=值表达式1，字段名2=值表达式2,...;</code></li>
</ul>
<p><strong>load data (载入数据) 语法</strong></p>
<p>使用于载入 结构整齐的纯文本数据。 前提也要有一个对应结构的已存在的表。</p>
<p>简单格式: <code>LOAD DATA INFILE &#39;文件名&#39; INTO TABLE 表名;</code></p>
<p><strong>删除数据</strong></p>
<p>形式: <code>delete from 表名 [where 条件] [order by 排序] [limit 限定];</code></p>
<p>说明:</p>
<ol>
<li>删除数据仍然是以行为单位进行</li>
<li>通常删除数据都需要带<code>where</code>条件，否则就会删除所有数据。</li>
<li><code>where</code>条件的语法跟<code>select</code>中的语法一样</li>
<li><code>order by</code> 排序设定，用于指定这些数据的删除顺序，他通常跟<code>limit</code>配合使用才有意义</li>
<li><code>limit</code>限定用于设定删除多少行(按<code>orderby</code> 设定顺序)</li>
</ol>
<h3 id="修改数据"><a href="#修改数据" class="headerlink" title="修改数据"></a>修改数据</h3><p>形式: <code>update 表名 set 字段1=值1, 字段2=值2,...[where 条件] [order by 排序字段][limit 限制行数];</code></p>
<p>说明:</p>
<ol>
<li>通常，<code>update</code>语句，也都需要<code>where</code>条件，否则: 就会修改所有(这很少见);</li>
<li><code>where</code>条件的语法跟select中语法一样;</li>
<li><code>order by</code> 用于设定修改的顺序，<code>limit</code>用于设定修改的行数，他们通常也是结合使用(虽然很少用)</li>
<li>实际应用中，通常很少用到<code>order by</code>和<code>limit</code>，修改的常规操作就成为: <code>update 表名 set 字段1=值1，字段2=值2,... where条件</code></li>
</ol>
<h3 id="数据查询语言-DQL"><a href="#数据查询语言-DQL" class="headerlink" title="数据查询语言 DQL"></a>数据查询语言 DQL</h3><p><strong>基本语法形式</strong></p>
<p><code>select [all | distinct] 字段或表达式列表 [from 子句] [where 子句] [group by 子句] [having 子句] [order by 子句] [limit 子句];</code></p>
<p><strong>字段或表达式列表</strong></p>
<ol>
<li>字段，肯定来源于表，所以必然依赖于<code>from</code>语句</li>
<li>表达式是类似这样一个内容: 8 ， 8+3， now(); //concat()函数是mysql中的系统函数，用于连接多个字符串。</li>
<li>每个输出项(字段或表达式结果)，都可以给其设定一个别名，形式为: 字段或表达式 <code>as</code> 别名。</li>
<li><code>all</code> 和 <code>distinct</code> 设定<code>select</code>出来的数据，是否消除重复行，可以不写，那就是默认值<code>all</code>。 <code>all</code>表示不消除，既所有都出来，默认值；<code>distinct</code>表示会消除。</li>
<li><code>form</code>，表示<code>select</code>部分从中取得数据的数据源—就是表。</li>
<li><code>where</code>，对数据源中的数据进行帅选的条件设定，所以<code>where</code>依赖于<code>form</code>子句。</li>
</ol>
<p><strong>is 运算符: 空值和布尔值的判断</strong></p>
<p>有四种情况:</p>
<ul>
<li><code>xx is null</code>: 判断某个字段是null值，就是没有值</li>
<li><code>xx is not null</code>: 判断某个字段不是null值</li>
<li><code>xx is true</code>: 判断某个字段为真</li>
<li><code>xx is false</code>: 判断某个字段为假，false，0，0.0，’’, null</li>
</ul>
<p><strong>其他扩展</strong></p>
<ul>
<li>位类型<code>bit</code>: 使用形式: <code>bit[(M)]</code> ，其中M是1~64的数字，表示使用多少位二进制数字来存储数据。插入形式为: b’value’ 比如: b’101’</li>
<li>序列类型<code>serial</code>: 只是BIGINT UNSIGNED NOT NULL AUTO_INCREMENT UNIQUE的一个别名(同义词)</li>
<li>布尔类型<code>bool</code>: 其实只是<code>tinyint(1)</code>的同义词，其值为<code>0</code>就表示<code>false</code>，否则为<code>true</code></li>
</ul>
<p><strong>between运算符: 范围判断</strong></p>
<p>用于判断某个字段的数据值是否在某个给定的范围之间–适用于数字类型</p>
<p>形式: <code>xx between 值1 and 值2;</code></p>
<p>含义: xx字段的值在给定值1和值2之间，其实相当于: xx&gt;=值1 and xx&lt;=值2</p>
<p><strong>in运算符</strong></p>
<p>给出确定数据的范围判断</p>
<p>语法: <code>xx in (值1, 值2, 值3, ...);</code></p>
<p>含义: 表示字段xx的值为所给出的这些值中的一个，就算是满足了条件；这些值，通常是零散无规律的。</p>
<p><strong>like运算符</strong></p>
<p>对字符串进行模糊查找</p>
<p>语法: <code>xx like &#39;要查找的内容&#39;</code></p>
<p>含义: 实现对字符串的某种特征信息的模糊查找，它依赖于一下两个特殊的符号。</p>
<ul>
<li><code>%</code> :它代表任何个数的任何字符</li>
<li><code>_</code> :它代表一个任何字符</li>
</ul>
<p><strong>group by 分组</strong></p>
<p>形式: <code>group by 字段1 [desc|asc] ,字段2 [desc | asc], ....</code></p>
<p>说明:</p>
<ol>
<li>分组是对前述已经找出的数据(既<code>where</code>已经筛选结束的)进行某种指定标准依据的分组。</li>
<li>同时，该分组结果，可以同时指定其 排序方式 ：<code>desc</code>倒序 ，<code>asc</code>顺序</li>
<li>通常，分组就是一个字段，2个以上很少</li>
</ol>
<p>什么叫做分组？</p>
<p>分组: 就是讲多行数据，以某种标准(就是指定的字段)来进行分类存放。</p>
<p>特别注意: 分组之后的结果，一定要理解为：只有一个个的组。 在部分语言此语法可能会出现不同的问题。</p>
<p>应用中，分组之后，通常只有如下几种可用的组信息。</p>
<ul>
<li>分组依据本身的信息，其实就是该分组依据的字段名</li>
<li>每一组的数量信息: 就是<code>count(*)</code>获得</li>
<li>原来数据中的 数值类型字段的聚合信息 包括如下几个:</li>
<li>最大值: <code>max(字段名)</code>; 最小值: <code>min(字段名)</code>; 平均值 <code>avg(字段名)</code>; 总和值: <code>sum(字段名)</code>; 上述其实是4个系统内部函数。</li>
</ul>
<p><strong>having 子句</strong></p>
<p><code>having</code>的作用和<code>where</code>完全一样，但其只是对 分组的结果数据 进行筛选。 既<code>where</code>对原始数据进行筛选； <code>having</code>对分组之后的数据进行筛选。</p>
<p>这里既是在<code>select</code> 后面没有写查询<code>count(*)</code> 时，在<code>having</code>设定筛选条件的时候，也可以使用，因为<code>count(\*)</code>是独立计算的结果，既对每一组进行原始数据行的统计，并用该条件进行筛选。</p>
<p><strong>恢复(导入)数据</strong></p>
<p>mysql登录后: <code>source &quot;备份数据文件的完整路径&quot;</code></p>
<p><strong>order by 子句</strong></p>
<p>用于 将前面取得的数据以设定的标准(字段)来进行排序以输出结果。</p>
<p>形式: <code>order by 字段1 [asc | desc], 字段2 [asc | desc], ...</code></p>
<p><strong>limit子句</strong></p>
<p>用于将 前述取得的数据 ，按指定的行取出来: 从第几行开始取出多少行。</p>
<p>形式: <code>limit</code> 起始行号 , 要取出的行号</p>
<p>说明: 行号默认从<code>0</code>开始， 行号和<code>id</code>没有关系。</p>
<h3 id="对select语句进行简要总结"><a href="#对select语句进行简要总结" class="headerlink" title="对select语句进行简要总结"></a>对select语句进行简要总结</h3><ol>
<li>虽然在形式上，<code>select</code>的很多子句都是可以省略的，但是他们的顺序(如果出现)，就不能打乱:必须仍然按照给出的顺序写出</li>
<li><code>where</code>子句依赖于<code>from</code>子句: 既没有<code>from</code>，就不能有<code>where</code></li>
<li><code>having</code>子句依赖于<code>group by</code>子句: 既没有<code>group by</code>就不能有<code>having</code></li>
<li><code>select</code> 中的字段也是依赖于<code>from</code>子句</li>
<li>上述子句的执行过程，基本上也是按照该顺序进行: – 从from的数据源中获取所有的数据，然后使用<code>where</code>对这些数据进行筛选，之后再使用<code>group by</code>子句对筛选出来的数据进行分组，接下来才可以使用<code>having</code>对这些分组的数据进行筛选，然后才可以<code>order by</code> 和<code>limit</code>。</li>
</ol>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://yoursite.com/2017/09/08/mysql/mysql_2 基本查询语句/" data-id="cj7bo43r20003v5pj2v2k51v0" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    
        <a href="http://yoursite.com/2017/09/08/mysql/mysql_2 基本查询语句/#comments" class="article-comment-link">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-mysql/mysql_1 数据库入门" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/09/08/mysql/mysql_1 数据库入门/">mysql_1 数据库入门</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/09/08/mysql/mysql_1 数据库入门/">
            <time datetime="2017-09-08T09:08:51.000Z" itemprop="datePublished">2017-09-08</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/mysql/">mysql</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/mysql/">mysql</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <blockquote>
<p>注：本文主要参考<a href="http://szysky.com" target="_blank" rel="external">http://szysky.com</a></p>
</blockquote>
<h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>SQL: 这是关系数据库的语言标准，<code>STRUCT QUERY LANGUAGE</code> (结构化查询语言);</p>
<p>几个基本的概念</p>
<ul>
<li>数据库<code>database</code>: 用于存储一个项目/产品/软件所使用的各种数据的一个逻辑单位</li>
<li>数据库管理系统<code>dbms</code>: 其实就是指一个具体的数据库软件产品:<code>database management system</code></li>
<li>表 <code>table</code>: 用于存储一种数据的结构形式</li>
<li>字段 <code>filed</code>，列 <code>column</code>: 一个数据表中的一个纵列，其实有一个名字又叫字段</li>
<li>记录 <code>record</code>，行 <code>row</code>:</li>
</ul>
<p><strong>mac mysql的默认数据库数据的路径</strong></p>
<p><code>/usr/local/var/mysql</code></p>
<p><strong>登录/退出mysql系统</strong></p>
<ul>
<li>登录: <code>mysql -h 服务器地址 -u 登录名 [-P 端口号] -p</code></li>
<li>完整登录: <code>mysql --host=服务器地址 --user=用户名 --port=端口 --password</code></li>
<li>退出: <code>quit; exit; \q;</code></li>
<li>注意: 登录数据库系统后，需要使用 <code>set names 编码名;</code> 来设定当前连接数据库的”环境编码名”，及当前跟数据库打交道的客户端本身的编码，通常来说，<code>cmd</code>客户端中是固定的<code>gbk</code>编码，而<code>php</code>网页中，是该网页文件的编码。</li>
</ul>
<p><strong>数据库的备份和恢复</strong></p>
<p>备份: 就是讲一个数据库，完整的转换为一个可以随时携带和传送的文件。</p>
<p>语法: <code>mysqldump -h 服务器地址 -u 登录名 -p 数据库名 &gt; 文件名</code></p>
<p>恢复: 就是将一个备份的数据库文件，完整的还原为一个可以使用的数据库。</p>
<p>语法: <code>mysql -h 服务器地址 -u 登录名 -p 数据库名 &lt; 文件名</code></p>
<p>注意: 这两个命令，都是在没有登录 进入的时候使用。其中<code>musqldump</code>命令还要求为管理员身份。</p>
<h3 id="技术语法规定"><a href="#技术语法规定" class="headerlink" title="技术语法规定"></a>技术语法规定</h3><p><strong>注释</strong></p>
<ol>
<li>单行注释: <code>#</code>注释内容</li>
<li>单行注释: <code>--</code>注释内容(–后面有空格存在)</li>
<li>多行注释: <code>/*</code>注释内容<code>*/</code></li>
</ol>
<p><strong>语句行</strong></p>
<p>默认情况下，以英文分号作为一条语句的结束，而且常规操作中都是一次执行一条语句。</p>
<p>mysql中可以认为设定语句的结束符。 <code>delimiter</code> 新的结束符。</p>
<p><strong>大小写问题</strong></p>
<p>mysql语言内部本身不区分大小写。但是<code>mysql</code>某些命令执行会生成文件夹，此时他们会区分，例如在区分大小写的系统中，<code>unix</code>，<code>linux</code>系统。</p>
<h3 id="数据库定义语句"><a href="#数据库定义语句" class="headerlink" title="数据库定义语句"></a>数据库定义语句</h3><p><strong>创建数据库</strong></p>
<p>形式: <code>create database 数据库名 [charset 字符编码名称] [collate 排序规则];</code></p>
<p>说明:</p>
<ul>
<li>字符编码名称是用于设定当前数据库中存储的字符内容以什么编码来存储。</li>
<li><code>collate</code>排序规则用于设定其中的字符内容的大小关系(先后顺序，对于英文基本没有任何问题,基本不用)。</li>
</ul>
<p>查看<code>mysql</code>可用的字符集: <code>show charset</code></p>
<p>查看<code>mysql</code>可用的排序规则: <code>show collation</code></p>
<p><strong>删除数据库</strong></p>
<p>形式: <code>drop database [if exists] 数据库名;</code></p>
<p>说明: <code>if exists</code> 适用于一种安全运行的考虑，如果数据库不存在，也不会报错。</p>
<p><strong>修改数据库(字符编码)</strong></p>
<p>基本上，就是修改数据库的属性：只有两个</p>
<p>修改编码和修改排序规则</p>
<p><code>alert database 数据库名 charset 新的编码名 collate 新的排序规则名</code></p>
<p><strong>显示所有数据库</strong></p>
<p><code>show databases;</code></p>
<p><strong>显示一个数据库的创建语句</strong></p>
<p>形式: <code>show create database 数据库名;</code></p>
<h3 id="字段类型-数据类型"><a href="#字段类型-数据类型" class="headerlink" title="字段类型(数据类型)"></a>字段类型(数据类型)</h3><p><code>mysql</code>中，数据类型主要分3大类，数字型，字符型，时间型</p>
<p><strong>整数字节</strong></p>
<p>主要有: <code>int</code>, <code>tinyint</code>, <code>smallint</code>, <code>mediumint</code>, <code>bigint</code></p>
<p>整数类型所占的空间字节:</p>
<ul>
<li><code>int</code>: 占4个字节，既32位</li>
<li><code>tinyint</code>: 占1个字节，既8位，最多能存储256个数字，默认范围是-128~127</li>
<li><code>bigint</code>: 占8个字节，既64位</li>
</ul>
<p>整数类型字段的设定形式：</p>
<ul>
<li><code>类型名 [(m)] [unsigned] [zerofill]</code></li>
</ul>
<p>说明:</p>
<ol>
<li><code>m</code>表示设定该整数的显示长度，既<code>select</code>输出的时候，123可能显示为00123.</li>
<li><code>unsigned</code>用于设定该整数位无符号数，其实就是没有负数</li>
<li><code>zerofill</code>用于设定是否填充 0 到一个数字的左边，此时需与设定的长度<code>m</code>配合。</li>
</ol>
<p><strong>小数类型</strong></p>
<p>有三种: <code>float</code>, <code>double</code> , <code>decimal</code></p>
<ul>
<li><code>float</code>: 单精度浮点型，使用4个字节存储数据，其精度大约只有6~7位有效数字</li>
<li><code>double</code>: 双精度浮点型，使用8个字节存储数据类型，其精度大约有20个有效数字</li>
<li><code>decimal</code>: 定点小数类型，整数部分最长可以有65位，小数部分最长可以有30位，一般设置格式为: <code>decimal</code>(总位数，小数部分位数)</li>
</ul>
<h3 id="php操作mysql数据库的必要代码"><a href="#php操作mysql数据库的必要代码" class="headerlink" title="php操作mysql数据库的必要代码"></a>php操作mysql数据库的必要代码</h3><p>通常在php网页中完成有关数据库的操作，首先需要如下代码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$link = mysql_connect(&quot;数据库服务器地址&quot;,&quot;用户名&quot;,&quot;密码&quot;);    //连接数据库系统</div><div class="line">mysql_query(&quot;set names 网页文件编码名&quot;);    //设定连接编码</div><div class="line">    //或者 mysql_set_charset(&quot;网页文件编码名&quot;);</div><div class="line">mysql_query(&quot;use 数据库名&quot;); //选定要使用的数据库</div><div class="line">    //或者: musql_select_db(&quot;数据库名&quot;);</div></pre></td></tr></table></figure>
<p>当执行了连接的前置动作 之后就可以使用<code>mysql_query(&quot;&quot;)</code>; 来执行任何的sql语句。</p>
<ul>
<li>场景一:执行没有数据返回的语句，比如：<code>insert,update,delete,create,create table,drop...</code>（通过true和false判断）</li>
<li>场景二:执行有数据返回的语句: <code>select, show tables,show databases, desc 表名(显示数据结构)</code>失败返回false，成功返回一个数据集。</li>
</ul>
<p>补充:<br><code>mysql_error()</code>: 获取<code>mysql</code>执行失败时的错误信息，通常在<code>mysql_query()</code>之后使用。</p>
<p><strong>结果集的处理</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">while($rec = mysql_fetch_array($result))&#123;</div><div class="line">    // mysql_fetch_array()会取出该结果集中的&quot;一行数据&quot;,并取得该行数据后赋值值给$rec;</div><div class="line">    //$rec就是一个数组，其下标就是字段名</div><div class="line">    //在此while循环中，mysql_fetch_array()会一次次(一行行)取出结果集中的所有数据。</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>fetch函数的3中形式</p>
<ul>
<li><code>mysql_fetch_assoc();</code> 返回的是字段名 和对应的字段值</li>
<li><code>mysql_fetch_row();</code> 返回的没有字段名以下标0为起始点作为键</li>
<li><code>mysql_fetch_array();</code> 返回的是键 为有规律的数字，也有字段名的两种组合，就是上面的两种组合。</li>
</ul>
<h3 id="扩展php中操作mysql数据的几个函数"><a href="#扩展php中操作mysql数据的几个函数" class="headerlink" title="扩展php中操作mysql数据的几个函数:"></a>扩展php中操作mysql数据的几个函数:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$n1 = mysql_num_rows(结果集);    //获得该结果集的数据行数</div><div class="line">$n2 = mysql_num_fields(结果集);    //获得该结果集的数据列数</div><div class="line">$n3 = mysql_field_name(结果集,$i);    //获得该结果集的第i个字段的名字，从0开始。</div></pre></td></tr></table></figure>
<h3 id="字段类型"><a href="#字段类型" class="headerlink" title="字段类型"></a>字段类型</h3><p><strong>字符类型</strong></p>
<ul>
<li><code>varchar</code>类型: 可变长度字符串，使用时我们必须设定其长度，其最大长度理论值为65535个，实际其实最大只能是65533个，单考虑到存储的字符编码不同，也会有进一步减少。例如如果哦存储中文<code>gbk</code>，则最多是65533/2个，如果存储中文<code>utf8</code>,则最多是65533/3个。此类型的实际长度是存储内容决定，而设定值只是表示最多可存储的字符个数，</li>
<li><code>char</code>类型: 定长字符串；使用时通常需要设定其长度，如果不设定默认是1，最大理论长度是255个。定长字符串使用与存储的数据都是可预见的明确的固定长度的字符，比如手机号，中国邮政编码。实际存储的时候，如果少于设定长度，也能存，但都会补空格填满。</li>
<li><code>enum</code>类型: 单选项字符串数据类型。它分成适用于存储表单界面中的<strong>单</strong>项值。它设定的时候，是需要给定固定的几个选项，然后存储的时候，就只存储其中一个值。<br>使用形式: <code>enum</code>(“选项1”,”选项2”,”选项3”,”选项4”….);<br>实际内部: 这些字符串选项值对应的是如下数字值:1234….65535个轩轩个</li>
<li><code>set</code>类型: 单选项字符串数据类型。它分成适用于存储表单界面中的<strong>多</strong>项值。它设定的时候，是需要给定固定的几个选项，然后存储的时候，就只存储其中若干值。<br>使用形式: <code>set</code>(“选项1”,”选项2”,”选项3”,”选项4”….);<br>实际内部: 这些字符串选项值对应的是如下数字值:1248….64个选项</li>
<li><code>text</code>类型: 长文本字符类型，通常，其中存储的数据不占据表格中的数据容量限制。其本身最长可存储65535个字符。其他同类字符类型: <code>smalltext,tinytext, longtext.</code></li>
</ul>
<p>其他类型(了解):</p>
<ul>
<li><code>binary</code>类型: 定长二进制字符串类型，里面存储的是二进制；</li>
<li><code>varbinary</code>类型: 边仓二进制字符串类型，里面存储的是二进制值；</li>
<li><code>blob</code>类型: 二进制数据类型，存的仍然是二进制值，但其适用于存储图片，其他文件等。单极少用。</li>
</ul>
<p><strong>时间类型</strong></p>
<ul>
<li><code>datetime</code>类型: 时间日期类型</li>
<li><code>date</code>类型: 日期类型</li>
<li><code>time</code>类型: 时间类型</li>
<li><code>year</code>类型: 年份类型</li>
</ul>
<p>在应用中，时间日期类型，在我们自己给定的数据情况下，需要使用单引号引起来，跟字符串一样。</p>
<p><code>timestamp</code>: 时间戳类型，就是指一个时间的数据值，本质就是一个数字，类似js中的<code>GetTime()</code>或php中的<code>Time()</code>。 它的一个重要的作用是: 是会自动获得时间戳的数据值–相当于”<code>now()</code>“</p>
<h3 id="表定义语句"><a href="#表定义语句" class="headerlink" title="表定义语句"></a>表定义语句</h3><p><strong>创建表</strong></p>
<p><code>create table [if not exists] 表名(字段列表[,索引或约束列表]) [表选项列表];</code></p>
<p><strong>字段设定形式</strong></p>
<p><code>字段名 类型 [字段属性1 字段属性2 ...]</code></p>
<ul>
<li>字段名可以自己取</li>
<li>类型就是前面所学的数据类型: <code>int, tinyint, float, double , char(5), varchar(25),text,datetime...</code></li>
<li>子弹属性可以有多个，相互之间直接空格隔开; 主要有<br><code>auto_increment</code>: 只用于整数类型，让该字段的值自动获得一个增长值。通常用于做一个表的第一个字段的设定，并且通常还当做主键(primary key)<br><code>primary key</code> : 用于设定该字段为主键，此时该字段的值就可以唯一的确定一行数据。<br><code>unique key</code>: 设定该字段是惟一的，也就是不重复的<br><code>not null</code>: 用于设定该字段不能为空。<br><code>default</code> xx值: 用于水规定该字段的默认值，如果此时insert没有给值得时候就使用该默认值<br><code>comment</code> : 字段说明文字。</li>
</ul>
<h3 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h3><p>系统内部自动维护的隐藏的数据表，它的作用是可以极大的加快数据的查询速度。</p>
<p>这个隐藏的数据表，其中的数据是自动排好序的，其查找速度就是建立在这个基础上的。</p>
<p><strong>索引的类型</strong></p>
<ul>
<li>普通索引: <code>形式 key(字段名)</code><br>含义 仅仅是一个索引，没有其他作用只能加快查找速度。</li>
<li>唯一索引: <code>形式 unique key(字段名)</code><br>含义 是一个索引，而且具有区分改变中的任何一行数据的作用(其实也是唯一性),与唯一索引区别，唯一性可以为null，而主键不能为空。</li>
<li>主键索引:<code>形式 primary key(字段名)</code></li>
<li>全文索引: <code>形式 fulltext (字段名)</code></li>
<li>外建索引: <code>形式 foreign key(字段名) references 其他表(对应其他表中的字段名)</code></li>
</ul>
<p>外键: 就是设定某个表中的某一个字段，它的数据的值，必须在另一个表中某个字段中存在。</p>
<h3 id="约束"><a href="#约束" class="headerlink" title="约束"></a>约束</h3><p>含义: 就是要求数据满足什么条件的一种规定。</p>
<ul>
<li>主键约束 作用：使该设定字段的值可以用于唯一确定一行数据，其实就是主键的意思</li>
<li>唯一约束 作用：是该设定字段字段具有唯一性，自然也是可区分的</li>
<li>外键约束 作用：使该设定字段的值，必须在其设定的对应表的对应字段中已经有该值了。</li>
<li>非空约束 not null: 设定一个字段时写的那个not null属性。</li>
<li>默认约束 default xx值. :设定一个字段的默认值属性。</li>
<li>检查约束 check(某种判断语句)。</li>
</ul>
<p>索引和约束其实是相同一件事情的不同角度的两种说法，例如方法和函数。</p>
<h3 id="表选项列表"><a href="#表选项列表" class="headerlink" title="表选项列表"></a>表选项列表</h3><p>创建一个表的时候，对该表的整体设定，主要有如下几个</p>
<ul>
<li><code>charset=要使用的字符编码</code></li>
<li><code>engine=要使用的存储引擎(也叫表选项)</code></li>
<li><code>auto_increment=设定当前表的自增长字段的初始值，默认是1</code></li>
<li><code>comment=&#39;该表的一些说明文字&#39;</code></li>
</ul>
<p>说明:</p>
<ol>
<li>设定的字符编码是为了跟数据库设定的不一样，如果一样就不需要设定了，因为其会自动使用数据库级别的设定。</li>
<li><code>engine</code> 存储引擎，在代码层面，就是一个名词:<strong>InnoDB</strong>,<strong>MyIsam</strong>,BDB,archive,Memory.</li>
</ol>
<p>存储引擎:</p>
<p>存储引擎是讲数据存储到硬盘的机制。不同的存储引擎，其实主要从两大层面设计存储机制-速度或者功能。</p>
<h3 id="修改表"><a href="#修改表" class="headerlink" title="修改表"></a>修改表</h3><p>说明:</p>
<ol>
<li>修改表，是指修改表的结构–正如创建表也是设定表的结构。</li>
<li>创建表能做的事，修改表几乎都能做–但不推荐去修改表，而是应该在创建表的时候就基本确定表的结构。</li>
<li>对字段进行增删改；对索引进行增删</li>
<li>标的选项通常都是修改，即使不写任何表选项，他们都有其默认值。</li>
</ol>
<p>常见的操作:</p>
<ul>
<li>新建字段: <code>alert table 表名 add [column] 新字段名 字段类型 [字段属性列表];</code></li>
<li>修改字段: <code>alert table 表名 change [column] 旧字段名 新字段名 新字段类型 [新字段属性列表];</code></li>
<li>删除字段: <code>alert table 表名 drop [column] 字段名;</code></li>
<li>添加普通索引: <code>alter table 表名 add key [索引名] (字段名1[,字段名2,...]);</code></li>
<li>添加唯一索引(约束): <code>alert table 表名 add unique key(字段名1[,字段名2,...]);</code></li>
<li>添加主键索引(约束): <code>alter table 表名 add primary key(字段名1[,字段名2,...]);</code></li>
<li>修改表名: <code>alter table 旧表名 rename [to] 新表名;</code></li>
</ul>
<h3 id="删除表"><a href="#删除表" class="headerlink" title="删除表"></a>删除表</h3><p><code>drop table [if exists] 表名;</code></p>
<h3 id="其他表的相关语句"><a href="#其他表的相关语句" class="headerlink" title="其他表的相关语句"></a>其他表的相关语句</h3><ul>
<li>显示当前数据库中的所有表: <code>show tables;</code></li>
<li>显示某表的结构: <code>desc 表名; 或者 describe 表名;</code></li>
<li>显示某表的创建语句: <code>show create table 表名;</code></li>
<li>重命名表: <code>rename table 旧表名 to 新表名;</code></li>
<li>从已有表复制表结构: <code>create table [if not exists] 新表名 like 元表名;</code></li>
</ul>
<h3 id="视图的定义"><a href="#视图的定义" class="headerlink" title="视图的定义"></a>视图的定义</h3><p>含义</p>
<p>类似于函数的功能。 就是一个<code>select</code>语句(通常比较复杂),我们给其一个名字(视图名),以后要使用该<code>select</code>语句，直接用该视图名就可以。</p>
<p>创建语法</p>
<p>语法形式: <code>create view 视图名 as select语句;</code></p>
<p>举例: <code>create view v1 as select id, fi, name, age from table where id&gt;7 and id&lt;100 or fi&lt;1000 and age&gt;10;</code></p>
<p>使用视图</p>
<p>当做一个表用即可： <code>select * from 视图名 [查询条件];</code></p>
<p>删除视图</p>
<p><code>drop view [if exists] 视图名;</code></p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://yoursite.com/2017/09/08/mysql/mysql_1 数据库入门/" data-id="cj7bo43qk0000v5pjysbrsxzl" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    
        <a href="http://yoursite.com/2017/09/08/mysql/mysql_1 数据库入门/#comments" class="article-comment-link">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-life/买车注意事项" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <p>提车注意事项：</p>
<p>一.验车前带齐发票、出厂证、保险单、保修单、说明书。</p>
<p>二.查对排汽量、出厂年月、车架号、发动机号。</p>
<p>三.环绕汽车一周，仔细查看油漆颜色、全车颜色是否一致。车身表面有无划痕、掉漆、开裂、起泡或锈蚀。用手摸一摸有无修补痕迹，不要被脏物或灰尘遮住残伤痕迹。<br>四.检查汽车有无（冷却液、润滑液、制动液、电解液及制冷液）泄漏现象。仔细检查一下机器各部位是否有漏油现象。通常可能漏油的部位是发动机的油底壳、变速器和后桥。只要观察一下这些部件的外壳是否有渗漏的油迹，或观察地面是否有滴油的痕迹，即可判明。打开前盖检查电瓶，水箱是否泄漏，各部分走线是否合理，有无混乱。<br>五.用手按压汽车前后左右4个角，松手后跳动不多于2次，表示减震器性能力好。</p>
<p>六.查看所有车灯是否正常，车门、车窗是否完整、玻璃有无损伤。</p>
<p>七.打开车门，检查车内座椅是否完整，座椅前、后是否可以调整。椅套是否整洁，真皮座椅是否有瑕疵，地面是否清洁、密封良好。车门把手开、关门是否灵活、安全、可靠，门窗密封条是否损坏。<br>八.车窗玻璃操纵机构工作是否正常。</p>
<p>九.坐进驾驶室，接通电源开头，检查刮水器（最好能检查自动感应雨刷是否不灵）、喷水清洁器工作是否正常。雨刮是否刮得干净。<br>十.用手晃动方向盘，上下不应有间隙，左右自由行程不应过大，表面手感要好。</p>
<p>十一.检查所有仪表显示是否正常。检查前照灯（大、小灯）、制动灯、防雾灯等工作是否正常。</p>
<p>十二.检查汽车喇叭。</p>
<p>十三.坐好后，手放在方向盘上，左脚踏离合器踏板，应感觉轻松自如，并有一小段自由行程；右脚踩下制动踏板不放，其应保持一定高度；油门踏板不应有犯卡、沉重、不回位的现象，腿、脚放在油门踏板上时，应自然舒适，这样才能保证长途驾驶不疲劳。</p>
<p>十四.检查里程表有无计录数字，其数值，零公里”，顾名思义就是几乎没有跑过的新车。当然，“零公里”并不是指里程表上显示的数字绝对为“0”，一般认为，里程表在60公里以下的，都可以认为是“零公里”。因为汽车厂家在试车、进出库、装载时要消耗掉一定的里程。<br>十五.提车记得问销售要你车附带的备件。</p>
<p>提车时除了点清车辆的各种证件，尤其是合格证，随车保养手册，三包凭证和工具等外，重点注意如下几点中的4和5这两点：</p>
<p>1，从外观上看，油漆没有任何腐蚀过的痕迹。</p>
<p>2，从油漆接口打开门，看门缝里面有没有新旧颜色之分。</p>
<p>3，从内饰上看有没有任何使用过的痕迹。</p>
<p>4，从发动机仓看，只要使用过的车辆在仔细对比的时候能够分得出清洗出来的新和原色新的区别，同时检查发动机舱里有无漏油，渗油。</p>
<p>5，从发动机内部使用的油色来看，打开加注机油的盖子或抽出机油尺，新车里面的是机油是原色，而且不会有任何的积炭，而使用过的车辆油色会有颜色略微发黑或发褐色。且加油口的盖子上会有被废气熏过的痕迹。</p>
<p>6，顶起来查看底盘，底盘应该是没有任何刮痕。同时检查变速箱有无漏油和渗油。</p>
<p>7，重点检测电瓶电量，同时检查电瓶桩头是否有松动，灯光是否一切完好。</p>
<p>8，检查轮胎气压，胎毛，胎壁上的红黄或白点是否清晰。</p>
<p>9，先熟悉下车辆各种性能。</p>
<p>10，车起步要平稳，发动机转速控制在2000-2500转内，不要急踩刹车，急加油门，和急踩制动。</p>
<p>最后再建议你确定提车时，请一个懂行的帮你把把关。</p>
<p>1首先要看出厂日期和车架号及公里数 出厂日期当然越近越好 尽量避免库存车。<br>2最基础的当然是外观的完好及漆面的光滑完好。<br>3下来是各种多功能配置 例如空调 音响 天窗 多功能方向盘等等。<br>4可以的话在4S里小范围试开一下 听听有没有异响或其他不正常的问题。</p>
<p>看别人回答的那么多，估计楼主也记不住，我当时提车也咨询过这个问题，但是真到提车那天，也都忘记了该注意哪些了，我把我提车的经历给楼主简单介绍下，希望楼主采纳<br>1、走到那里首先要的是 汽车合格证书（没有这个是无法交税挂牌的，非常重要），发票，保修凭证，等等还有其他证书。<br>2、销售把车子给你开出来之后，当然要仔细看看汽车周围有没有划痕啊、或者喷漆不均匀啊（这个基本看不出来），外观有没有不好的地方<br>3、打开发动机盖子，检查发动机 编号 车架子号 与合格证书 上面的是否一致，<br>4、检查冷却液、发动机机油 、制动液 是否在对应的位置，会不会偏少<br>5、检查汽车行驶里程多少了，新车一般10KM左右，检查轮胎 的胎毛是否仍完好，跑多了胎毛会被磨损的。<br>6、检查车子灯光 有无问题、车窗升降有无问题，还有夏天了试试空调给不给力！ </p>
<p>我当时提车基本上就检查了这些，再多说了，，其实真去提车 也顾不得检查那么多了 </p>
<p>最主要的还是合格证 发票 保单（商业险1联 交强险2联）保修手册 说明书</p>
<p>请参考<br>1、检查车子外观，原车保护膜不应该有损坏，然后检查各个部位，不能有搽痕，<br>检查没有问题后可以揭掉保护膜，再次检查外观。<br>2、检查车子各部件，灯光、转向、雨刷、刹车灯等是不是正常，检查车门密封，音响效果，检查车钥匙遥控器及防盗功能。<br>3、检查机油、防冻液、电瓶、玻璃水要在标准线上，不能过高也不能过低，否则都会影响正常性能。<br>4、检查轮胎气压。<br>5、检查行车电脑，总公里一般不大于20公里。<br>6、检查出厂日期，时间最好不要超过1个月。<br>7、检查随车工具及配件。<br>8、细听发动机声音，要运转均匀平稳<br>9、开车运行，不能有其他杂音。<br>10、检查门窗、天窗、后备箱等开启是否灵活</p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://yoursite.com/2017/09/08/life/买车注意事项/" data-id="cj7bo43rc0009v5pjah7nsecr" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    
        <a href="http://yoursite.com/2017/09/08/life/买车注意事项/#comments" class="article-comment-link">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-android/books/《Android编程权威指南》Chap1_ 零散整理" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2017/09/07/android/books/《Android编程权威指南》Chap1_ 零散整理/">《Android编程权威指南》Chap1_ 零散整理</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/09/07/android/books/《Android编程权威指南》Chap1_ 零散整理/">
            <time datetime="2017-09-07T09:44:18.000Z" itemprop="datePublished">2017-09-07</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/android/">android</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/android/《Android编程权威指南》/">《Android编程权威指南》</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/android/">android</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <blockquote>
<p>这本书属于入门, 有很多内容可以当做扩展来了解一些API, 并且有的时候可以适当的利用Google提供好的API来做一些高效开发节约时间成本. 原理东西本书偏少. 不过可以学习本书中的代码的编写风格, 书中代码都是采用<strong>MVC</strong>模型来编写的. 就写这么多, 下面开始整理一些小知识点.<br>注：本文主要参考<a href="http://szysky.com" target="_blank" rel="external">http://szysky.com</a></p>
</blockquote>
<h2 id="Activity的生命周期"><a href="#Activity的生命周期" class="headerlink" title="Activity的生命周期"></a>Activity的生命周期</h2><p>有7种分别为: 除去<code>onRestart()</code>比较特殊一点的生命周期. 可以把<code>activity</code>认为分别在<strong>3种状态</strong>切换, 分别是<code>运行, 暂停, 停止</code>.</p>
<h2 id="配置文件改变导致Activity重建-如屏幕旋转"><a href="#配置文件改变导致Activity重建-如屏幕旋转" class="headerlink" title="配置文件改变导致Activity重建,如屏幕旋转"></a>配置文件改变导致Activity重建,如屏幕旋转</h2><p><strong>设备配置(device configuration)</strong>是用来描述设备当前状态的一系列特征. 这些特征包括<strong>屏幕的方向, 手机语言, 屏幕的密度, 屏幕的尺寸, 键盘类型, 底座模式等</strong></p>
<p>在开发中有时候需要为了匹配不同的设备配置, 我们会提供多套副本文件. 比如说:</p>
<ul>
<li>图片放在不同的<code>dpi</code>密度的文件夹下;</li>
<li>适应手机的横竖屏创建不同的文件夹并编写不同展示风格的xml布局放入.</li>
<li>创建不同语言的<code>strings</code>文件. 来实现语言国际化</li>
<li>…..</li>
</ul>
<p>这里列举一下创建<strong>水平模式下加载另一个布局文件</strong>, 在<code>res/</code>资源文件夹下创建一个<code>layout-land</code>目录, 创建一个与<code>layout</code>文件夹中布局文件<code>名称相同</code>的xml. 然后编写想在横屏时候需要显示的布局.</p>
<p>其实当手机处于<strong>横屏的时候</strong>需要加载资源文件. 这个时候系统首先查找开发者是否创建对应横屏的文件夹就是<code>layout-land</code>,如果有. 那么继续查找资源ID所对应的文件是否存在. 如果存在那么就加载这个文件. 如果没有就从<code>layout</code>文件夹中加载默认的文件(layout文件夹优先级基本上是最低的)</p>
<h2 id="异常重建时Activity的数据保存"><a href="#异常重建时Activity的数据保存" class="headerlink" title="异常重建时Activity的数据保存"></a>异常重建时Activity的数据保存</h2><p>由于本地手机的配置文件的改变, 如屏幕旋转造成了<code>Activity</code>的重建. 这个时候就会导致已经实例对象或者属性赋值全部丢失.</p>
<p>利用<code>onSaveInstanceState(Bundle)</code>一般会在<code>onPause()</code>之后被调用. 把要存储的数据添加到<code>onSaveInstanceState()</code>的参数类型为<code>Bundle</code>的参数中. 然后当销毁后的重建时, 会在<code>onCreate()</code>方法中会传回一个<code>Bundle</code>类型的对象. 可以取出. 如果不是异常销毁重建那么默认情况下<code>onCreate()</code>回调方法带回的<code>Bundle</code>类型的参数是为<code>null</code>的.</p>
<h2 id="SDK版本小解和兼容处理"><a href="#SDK版本小解和兼容处理" class="headerlink" title="SDK版本小解和兼容处理"></a>SDK版本小解和兼容处理</h2><ul>
<li><strong>SDK最低版本:</strong> 当应用安装的时候, 手机会检测如果本身系统等级如果低于应用指定的最低版本那么应用无法安装.</li>
<li><strong>SDK目标版本</strong> 应用是设计给哪个API级别去运行的. 大多数情况下, 目标版本即最新发步的Android版本.</li>
<li><strong>SDK编译版本</strong> <code>Compile</code>. 前两个是通知手机设备的. 而这个属性是告知<code>Android Studio</code>编译器使用哪一个SDK版本进行代码编译.</li>
</ul>
<hr>
<p>有时候我们可能会使用高版本的API. 但是有可能手机的版本会低于这个API的出现版本. 这个时候就需要在代码中进行逻辑判断分支.</p>
<ul>
<li><code>Build.VERSION.SDK_INT:</code>代表了当前运行的Android手机的版本号.</li>
</ul>
<p>通过判断当前手机的版本号, 这样就可以针对不同的场景进行分支处理.</p>
<h2 id="XML布局属性"><a href="#XML布局属性" class="headerlink" title="XML布局属性"></a>XML布局属性</h2><p><strong>样式,主题, 主题属性</strong></p>
<p><strong>样式(style)</strong>是xml资源文件, 含有用来描述组件行为和外观的属性定义的集合. 例如在<code>res/valus/styles.xml</code>中声明如下样式.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;style name=&quot;BigTextStyle&quot; &gt;</div><div class="line">   &lt;item name=&quot;android:textSize&quot;&gt;20sp&lt;/item&gt;</div><div class="line">   &lt;item name=&quot;android:layout_margin&quot;&gt;5dp&lt;/item&gt;</div><div class="line">&lt;/style&gt;</div></pre></td></tr></table></figure>
<p>在以后的所有大的文字控件<code>textView</code>,<code>button</code>.都可以直接引入一个<code>style</code>属性. 当重复的属性越多, 使用的控件也越多, 这种好处是不言而喻的.</p>
<hr>
<p><strong>主题(theme)</strong></p>
<p>Android自带了一些供应使用的预定义平台主题. 例如:<code>android:theme=&quot;@style/Theme.AppCompat.Light&quot;</code>.</p>
<p>引用主题属性:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;TextView</div><div class="line">  android:layout_width=&quot;match_parent&quot;</div><div class="line">  android:layout_height=&quot;wrap_content&quot;</div><div class="line">  style=&quot;?android:listSeparatorTextViewStyle&quot;/&gt;</div></pre></td></tr></table></figure>
<p>例如这样后, 你会发现<code>textView</code>会带有<strong>margin</strong>,<strong>字体颜色</strong>,<strong>加粗</strong>等一些属性. 这就在一些场合很方便的设置了一些属性. 并且也能达到我们看着不那么丑的需求.</p>
<hr>
<p><strong>dp, sp</strong></p>
<ul>
<li><code>dp (density-independent):</code>一般用于设置控件宽高和<code>margin</code>,<code>padding</code>. dp值代表的实际长度与手机的<strong>屏幕分辨率</strong>和<strong>屏幕尺寸</strong>没有直接关系,但是有间接关系. 是这样. 根据<strong>屏幕的分辨率</strong>和<strong>屏幕尺寸</strong>会得到一个<strong>屏幕的像素密度</strong>. 根据这个屏幕像素密度来决定1dp在当前设备代表着几个像素点.</li>
<li><code>sp (scale-independent pixel):</code>. 主要用于字体. 和dp相似会根据手机的密度来动态的选择对应的大小. 但是有一点不同. 这种像素会受<strong>手机字体的偏好设置而改变</strong></li>
</ul>
<hr>
<p><strong>布局参数</strong></p>
<p>对于资源文件xml中标签的属性<code>android:layout_width</code>,<code>android:layout_margin</code>,<code>android:text</code>等等, 为什么有的属性前面有<strong>layout</strong>开头, 而有的没有呢.</p>
<p>其实名称<strong>以layout_</strong>来头的属性是作用于组件的<strong>父组件</strong>. 我们将这些属性统称为<strong>布局参数</strong>. 它们会告知父布局如何在内部安排自己的子元素.</p>
<p>而<strong>不以layout_开头</strong>的属性是作用于组件的. 组件生成时, 会调用某个方法按照属性即属性值进行自我配置.</p>
<hr>
<p><strong>外边距于内边距</strong></p>
<p>根据上面的结论, 应该就可以看出<code>layout_margin</code>,<code>padding</code>这两个属性. 一个是作用父布局一个是作用在自己身上的. 所以在自定义<strong>ViewGroup</strong>的时候不仅要获取子孩子的宽高还要获取<code>margin</code>这样才能正确的布局. 而在自定义<code>View</code>的时候我们往往要兼顾到padding这个属性. 不然设置<code>padding</code>的属性就会无效果.</p>
<h2 id="ViewPager简单介绍"><a href="#ViewPager简单介绍" class="headerlink" title="ViewPager简单介绍"></a>ViewPager简单介绍</h2><p><code>ViewPager</code>在某种程度上有点类似于<code>AdapterView(ListView的超类)</code>. <code>AdapterView</code>需借助于Adapter才能提供视图. 所以同样的<code>ViewPager</code>也需要<code>PagerAdapter</code>的支持.</p>
<p><code>ViewPager</code>可能开发中用的很多. 在使用<code>ViewPager</code>作为一个<code>fragment</code>容器的时候. <code>FragmentManager</code>要求其容器视图必须<strong>具备id属性</strong>. 所以如果是代码中动态的创建ViewPager.那么别忘了设置id属性, 如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">protected void onCreate(@Nullable Bundle savedInstanceState) &#123;</div><div class="line">        super.onCreate(savedInstanceState);</div><div class="line">        //  动态创建ViewPager并设置到setContent</div><div class="line">        mViewPager = new ViewPager(getApplicationContext());</div><div class="line">        // 如果需要对Fragment进行托管, 那么要求其容器视图必须具备资源ID</div><div class="line">        mViewPager.setId(R.id.vp_main);</div><div class="line">        setContentView(mViewPager);</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">// 在res/values/ids.xml 没有可以新建一个,为了创建独立资源id</div><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;resources&gt;</div><div class="line">    &lt;item name=&quot;vp_main&quot; type=&quot;id&quot;/&gt;</div><div class="line">&lt;/resources&gt;</div></pre></td></tr></table></figure>
<p>这样就可以实现动态添加<code>ViewPager</code>并作为<code>Fragment</code>的容器了.</p>
<hr>
<p>由于直接通过<code>PagerAdapter</code>派生出子类有很多场景步骤过于复杂. 我们可以根据具体作用场景来选择其子类来作为ViewPager的适配器.比如说<code>FragmentStatePagerAdapter</code></p>
<p>实现很简单如下: 复写两个方法就可以</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">// 在fragment中的onCreate()中直接设置就可以</div><div class="line">// 利用ViewPager的子类 FragmentStatesPagerAdapter可以简单的处理并是实现</div><div class="line">// 当使用fragment 还有一个选择FragmentPagerAdapter 两者的区别是在卸载不再需要的fragment的时候有所不同</div><div class="line">// FragmentPagerAdapter创建的fragment只是有销毁视图的动作, 没有将其从FragmentManager里面删除</div><div class="line">FragmentManager fm = getSupportFragmentManager();</div><div class="line">mViewPager.setAdapter(new FragmentStatePagerAdapter(fm) &#123;</div><div class="line">            @Override</div><div class="line">            public Fragment getItem(int position) &#123;</div><div class="line">                //...相当于每个pager要展示的fragment.</div><div class="line"></div><div class="line">                return crimeFragment;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            @Override</div><div class="line">            public int getCount() &#123;</div><div class="line">                // 返回Pager页的大小</div><div class="line">                return mCrimes.size();</div><div class="line">            &#125;</div><div class="line">        &#125;);</div></pre></td></tr></table></figure>
<p>可以看到当创建了<code>FragmentStatePagerAdapter(..)</code>传入了一个<code>FragmentManager</code>给其构造方法. 因为实际上<code>FragmentStatePagerAdapter</code>是我们的代理, 负责管理与<code>ViewPager</code>的对话并协同工作.代理需首先将<code>getItem()</code>方法返回的<code>Fragment</code>添加到<code>Activity</code>. 然后才能使用fragment完成自己的工作. 这也是需要传递<code>fm</code>的原因.</p>
<p><strong>如果需要监听ViewPager的滑动事件</strong></p>
<p>给ViewPager设置<code>setOnPageChangeListener()</code>注册一个回调监听, 里面有三个状态回调:</p>
<ol>
<li><code>onPageScrollStateChange</code>: 告知当前页面所处的行为是什么.</li>
<li><code>onPageScrolled</code>: 告知当前显示的页面是哪个, 并且现在已经滑动导致的偏移距离是多少.</li>
<li><code>onPageSelected</code>: 告知页面滑向了哪里.可以得知是在数据集合中的第几个Pager被显示出来了</li>
</ol>
<p><strong>关于FragmentStatePagerAdapter与FragmentPagerAdapter</strong></p>
<p>主要区别就是: <strong>二者在卸载不再需要的fragment时,所采用的处理方式有所不同</strong></p>
<ul>
<li><code>FragmentStatePagerAdapter</code>: 会销毁不需要的<code>fragment</code>. 事务提交后, 可将<code>fragment</code>从<code>activity#FragmentManager</code>中彻底移除. 而类名中的<code>state</code>表明: 在销毁<code>Fragment</code>时, 他会将其<code>onSaveInstanceState()</code>方法中的<code>bundle</code>信息保存下来. 当用户切换回来的时候, 保存实例状态可用于恢复生成新的<code>fragment</code></li>
<li><code>FragmentPagerAdapter</code>: 对于不再需要的<code>fragment</code>, 其对应的<code>FragmentManager</code>则选择调用事务的<code>detach(Fragment)</code>方法. 而非<code>remove(Fragment)</code>方法. 也就是说,<code>FragmentPagerAdapter</code>只是销毁了fragment的视图, 但仍将<code>fragment</code>实例保留在<code>FragmentManager</code>中</li>
</ul>
<p>而如何取决需要按场景来使用: <code>FragmentStatePagerAdapter</code>更节省内存. 如果需要展示的数据很多,如果使用<code>FragmentPageAdapter</code>那么会保存大量的信息, 并且占用很多空间就不是很合适.</p>
<p>所以如果用户界面只需要<strong>少量固定</strong>的fragment. 那么使用<code>FragmentPagerAdapter</code>比较合适. 否则就反之使用<code>FragmentStatePagerAdapter</code>.</p>
<h2 id="资源文件的配置与匹配"><a href="#资源文件的配置与匹配" class="headerlink" title="资源文件的配置与匹配"></a>资源文件的配置与匹配</h2><p>先看一下以下项目结构目录截图:</p>
<p><img src="http://szysky.com/2016/09/07/%E3%80%8AAndroid%E7%BC%96%E7%A8%8B%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B%E9%9A%8F%E8%AE%B0%E4%B8%80/local_1.png" alt="img"></p>
<p>有三个<code>value</code>文件夹, 第一个为我们的默认加载的<code>value</code>, 第二个为使用了<strong>横屏修饰符修饰声明</strong>, 第三个使用了<strong>指定语言修饰符声明</strong>. 里面都有一个<code>strings</code>文件夹看一下内容. 这里只拿<code>app_name</code>属性来说明测试, 三个文件都有此属性.</p>
<p><img src="http://szysky.com/2016/09/07/%E3%80%8AAndroid%E7%BC%96%E7%A8%8B%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B%E9%9A%8F%E8%AE%B0%E4%B8%80/local_2.png" alt="img"></p>
<p>具有不同的修饰符的<strong>同种功能的文件夹是具有不同优先级的</strong>. 还是以上面的图片为例子. 如果说在首页<code>Activity</code>引用了<code>app_name</code>这个字符串. 那么根据不同的场景会去加载不同的资源文件.</p>
<ul>
<li><strong>如果本地语言指定了中文:</strong> 那么就会加载<code>values-zh</code>文件中的资源(此文件夹的配置修饰符优先级在上面的三种场景最高).</li>
<li><strong>如果本地语言非中文, 并且是横屏状态下:</strong> 那么会加载<code>values-land</code>文件中的资源</li>
<li><strong>如果即没有指定为中文,也不是横屏状态下, 那么就加载默认的资源文件</strong> <code>values</code>文件夹</li>
</ul>
<p>可以看出来app加载资源文件的时候是按照一定优先级去加载的, 首先会先排除掉不兼容当前设备配置的资源目录. 如果有多个文件匹配那么高优先级的文件夹首先会检查当前手机环境对应的配置是否匹配(比如是否横屏,是否设置某种本地语言). 匹配成功之后就会加载对应的文件夹下的内容. 而低优先级的对应功能的文件夹不会再去加载. 但是如果发现匹配不成功或者成功之后没有找到对应的属性那么还会继续往低优先级的查找. 直到找到为止.</p>
<p>所以可以看出一个属性值,最少要保证在资源文件中存在一份. 否则会出现加载错误, 并且需要处理好场景之间无值可选的问题.</p>
<p>下面列出大部分具有配置修饰符的设备特征. 他们的优先级从高到低排列的</p>
<table>
<thead>
<tr>
<th>优先级(数值越低越高)</th>
<th>特征说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>移动国家码, 通常附有移动网络码</td>
</tr>
<tr>
<td>2</td>
<td>语言代码, 通常附有地区代码</td>
</tr>
<tr>
<td>3</td>
<td>布局方向</td>
</tr>
<tr>
<td>4</td>
<td>最小宽度</td>
</tr>
<tr>
<td>5</td>
<td>可用宽度</td>
</tr>
<tr>
<td>6</td>
<td>可用高度</td>
</tr>
<tr>
<td>7</td>
<td>屏幕尺寸</td>
</tr>
<tr>
<td>8</td>
<td>屏幕纵横比</td>
</tr>
<tr>
<td>9</td>
<td>屏幕方位</td>
</tr>
<tr>
<td>10</td>
<td>UI模式</td>
</tr>
<tr>
<td>11</td>
<td>夜间模式</td>
</tr>
<tr>
<td>12</td>
<td>屏幕显示密度</td>
</tr>
<tr>
<td>13</td>
<td>触摸屏类型</td>
</tr>
<tr>
<td>14</td>
<td>键盘可用性</td>
</tr>
<tr>
<td>15</td>
<td>首选输入法</td>
</tr>
<tr>
<td>16</td>
<td>导航键可用性</td>
</tr>
<tr>
<td>17</td>
<td>非文本导航方法</td>
</tr>
<tr>
<td>18</td>
<td>API级别</td>
</tr>
</tbody>
</table>
<p>资源文件夹也可以使用<strong>多重配置修饰符</strong>, 例如<code>values-zh-land</code>, 各修饰符必须按照优先级高低排序.否则无效. 例如<code>values-land-zh</code>就是无效的目录. 这里就不细说. 可在官网<strong>guide/topics/resources/providing-resources</strong>查看.</p>
<hr>
<p><strong>资源命名</strong></p>
<p>资源的文件只能有小写字母组成并且不能包含空格.</p>
<p>无论是在XML中还是在代码中引入资源, 引用都不包括文件的扩展名. 所以<strong>在同级目录下不能以文件的扩展名作为依据来区分命名相同的文件. 也不允许同级下名称相同扩展名不同的文件存在,在编译时候会报错</strong></p>
<p><strong>布局文件命名</strong></p>
<p>最好按文件名排序的声明文件名. 通常以其定义的视图类型名为前缀. 如<code>activity_</code>,<code>dialog_</code>,<code>list_item_</code>.这样查找分类就容易多了.</p>
<p><strong>资源目录结构</strong></p>
<p>所有的资源都应该保存在<code>res/</code>目录的子目录下, 常见的子目录有<code>drawable/</code>,<code>mipmap/</code>,<code>layout/</code>,<code>values/</code>,<code>raw/</code>, <code>menu/</code>等.</p>
<p><code>Android</code>会无视<code>res/</code>目录下的其他子目录.</p>
<h2 id="操作栏"><a href="#操作栏" class="headerlink" title="操作栏"></a>操作栏</h2><p>也可以认为是title bar. 说法很多. 如下</p>
<p><img src="http://szysky.com/2016/09/07/%E3%80%8AAndroid%E7%BC%96%E7%A8%8B%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B%E9%9A%8F%E8%AE%B0%E4%B8%80/titlebar.png" alt="img"></p>
<p>可显示在操作栏上的菜单被称作<strong>选项菜单</strong>, 选项菜单类似于<code>popupWind</code>.可以作为用户的扩展操作.</p>
<p><strong>1.首先在XML文件中定义选项菜单</strong></p>
<p><code>res/menu/</code>目录下创建一个xml. 根标签为<code>&lt;menu&gt;</code>如下</p>
<p><img src="http://szysky.com/2016/09/07/%E3%80%8AAndroid%E7%BC%96%E7%A8%8B%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B%E9%9A%8F%E8%AE%B0%E4%B8%80/menu_1.png" alt="img"></p>
<p>或者你可以这样</p>
<p><img src="http://szysky.com/2016/09/07/%E3%80%8AAndroid%E7%BC%96%E7%A8%8B%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B%E9%9A%8F%E8%AE%B0%E4%B8%80/menu_2.png" alt="img"></p>
<ul>
<li><code>showAsAction</code>属性用于指定菜单选项是显示在操作栏上, 还是隐藏到<strong>溢出菜单</strong>中. 比如上图中的<code>app:showAsAction=&quot;ifRoom|withText&quot;</code>是一个组合属性. 代表着只要操作栏可用的控件足够,菜单项图标和文字描述都会显示在操作栏中. 这个属性值不设定的情况下默认是<strong>溢出菜单</strong>模式显示的. 如果空间仅够显示图片那么文字不会显示, 如果剩余空间即不够显示文字也不够显示图标, 那么菜单项会被转移隐藏到菜单中.</li>
<li>上面这个属性值还有两个可设置项<code>always</code>和<code>never</code>. 不推荐使用<code>always</code>, 应尽量使用更方便的<code>ifRoom</code>属性值, 让操作系统系统决定如何显示菜单项. 对于那些很少用到的菜单项, 使用<code>never</code>是个不错的选择.</li>
<li><code>icon:</code> 属性使用了系统的图标资源. 这个资源只存在于设备上.</li>
</ul>
<p><strong>2. 菜单文件创建完之后,就该代码设置了</strong></p>
<p>首先<code>Activity</code>提供了管理选项菜单的回调函数. 在需要选项菜单的时候, <code>Android</code>会调用其<code>onCreateOptionsMenu()</code>方法.</p>
<p>如果你使用的是<code>Fragment</code>那么也没关系因为<code>Fragment</code>也有同名的函数为你使用. 接下来以在<code>Fragment</code>为例说明.</p>
<p>复写<code>onCreateOptionsMenu()</code>函数. 通过<code>inflate</code>进行填充布局到<code>menu</code>对象中. 如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">@Override</div><div class="line">public void onCreateContextMenu(ContextMenu menu, View v, ContextMenu.ContextMenuInfo menuInfo) &#123;</div><div class="line">   // 为操作栏创建浮动的上下文菜单</div><div class="line">   mActivity.getMenuInflater().inflate(R.menu.crime_list_item_context, menu);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然后在<code>Fragment#onCreate()</code>方法中添加一段代码 <code>setHasOptionsMenu(true);</code></p>
<p><strong>说明:</strong> <code>Fragment#onCreateOptionsMenu()</code>方法是由<code>FragmentManager</code>负责调用的. 因此当<code>activity</code>接收到来自操作系统的<code>onCreateOptionsMenu()</code>方法回调请求时, 我们需要明确的告诉<code>FragmentManager</code>需接收选项菜单的方法回调.就是<code>setHasOptionsMenu()</code>.</p>
<p>现在我们的选项菜单就已经可以显示出来.</p>
<p><strong>3. 响应菜单选项选择的事件</strong></p>
<p>既然添加了扩展功能的选项, 那么必定需要实现某些点击事件. 通过复写<code>onOptionsItemSelected()</code>来进行处理. 有于我们可能在<code>menu.xml</code>中声明了多个item. 为了区分点击的是哪一个. 可以通过id来识别不同的点击触发. 如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">@Override</div><div class="line">    public boolean onOptionsItemSelected(MenuItem item) &#123;</div><div class="line">        switch (item.getItemId())&#123;</div><div class="line">            case R.id.menu_item_new_crime:</div><div class="line">                // 做一些想做的事情</div><div class="line">                return true;</div><div class="line"></div><div class="line">            case R.id.menu_item_show_subtitle:</div><div class="line">                //  设置操作栏的子标题</div><div class="line">                ActionBar supportActionBar = ((AppCompatActivity) getActivity()).getSupportActionBar();</div><div class="line"></div><div class="line">                if (supportActionBar.getSubtitle() == null)&#123;</div><div class="line">                    supportActionBar.setSubtitle(sub_description);</div><div class="line">                    item.setTitle(R.string.hide_subtitle);</div><div class="line">                &#125;else&#123;</div><div class="line">                    supportActionBar.setSubtitle(null);</div><div class="line">                    item.setTitle(R.string.show_subtitle);</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                return true;</div><div class="line"></div><div class="line">            default:</div><div class="line">                return super.onOptionsItemSelected(item);</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>你可能看到上面有一行注释写的设置<strong>操作栏的子标题</strong>这个的效果如下图.</p>
<p><img src="http://szysky.com/2016/09/07/%E3%80%8AAndroid%E7%BC%96%E7%A8%8B%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B%E9%9A%8F%E8%AE%B0%E4%B8%80/subtitle.png" alt="img"></p>
<p><strong>4. 层级式导航,向左后退箭头</strong></p>
<p>虽然大多数都是自定义的<code>titlebar</code>, 但是对于系统的默认后退也应该了解.</p>
<p>通过<code>Activity#getSupportActionBar().setDisplayHomeAsUpEnable()</code>. <strong>(通过测试发现当在二级界面的时候默认都会出现向左的后退箭头但是默认的是没有处理的, 需要在onOptionsItemSelected()做对应的处理,我这里测试的环境为sdk为24,使用的AppCompatActivity派生的子类)</strong></p>
<p>所以如果是<code>fragment</code>开发为基础, 那么别忘了<code>setHasOptionsMenu(true)</code>, 允许<code>FragmentManager</code>对自己的<code>fragment</code>队列进行菜单选项的事件分发回调. 如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">@Override</div><div class="line">public boolean onOptionsItemSelected(MenuItem item) &#123;</div><div class="line">   switch (item.getItemId())&#123;</div><div class="line">       // android.R.id.home 就是默认的向左箭头组件的id</div><div class="line">       case android.R.id.home:</div><div class="line">           getActivity().finish();</div><div class="line">           return true;</div><div class="line"></div><div class="line">       default:</div><div class="line">           return super.onOptionsItemSelected(item);</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>还有一个问题!</strong></p>
<p>Android编程, 有时候你以为已经丝入扣, 天衣无缝, 可以高枕无忧的时候上线, 总是会被人提醒到好像还有一个问题!</p>
<p>上面的二级标题是否还记得. 有这么一个场景如果二级标题显示了, 但是发生了设备旋转! ok 那么重建后你会发现二级标题不存在了. 这时就可以使用<code>setRetaionInstance(true)</code>来保存成员属性. 并利用一个布尔值来控制在创建菜单选项的时候二级标题是否需要显示.</p>
<h2 id="Android的文件系统与Java-I-O"><a href="#Android的文件系统与Java-I-O" class="headerlink" title="Android的文件系统与Java I/O"></a>Android的文件系统与Java I/O</h2><p>在操作系统级别, <code>Android</code>运行在<code>Linux</code>内核之中, 因此,它的文件系统类似于其他一些Linux或Unix系统. 目录名称已正斜杠<code>/</code>分隔. 文件名可由各类字符组成, 且区分大小写. 受益于<code>Linux</code>的安全模式, 应用都是以特定的用户ID运行的.</p>
<p><code>Android</code>利用应用的java包名, 来决定应用在文件系统中的存放位置. 用于发布与安装, 应用本身被打包成APK文件格式. 被放置在<code>/data/app</code>目录. 当然这是需要进行<code>root</code>权限才可以的.</p>
<p><strong>访问文件和目录</strong></p>
<p>应用访问文件和目录最便捷的方式是使用<code>Content</code>类提供的方法. <code>Content</code>类是所有关键应用组件的超类.</p>
<p>下面是Content提供的基本文件或目录的便捷方法</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>使用目的</th>
</tr>
</thead>
<tbody>
<tr>
<td>File getFilesDir()</td>
<td>获取<code>data/data/&lt;packname&gt;/files</code>目录</td>
</tr>
<tr>
<td>FileInputStream openFileInput(String name)</td>
<td>打开<code>data/data/&lt;packname&gt;/files/</code>目录下的name文件名的文件获得输入流</td>
</tr>
<tr>
<td>FileOutputStream openFileOutput(String name, int mode)</td>
<td>同上, 这个是获得输出流, 不同之处如果没有这个文件那就会自动创建</td>
</tr>
<tr>
<td>File getDir(String name, int mode)</td>
<td>获取<code>data/data/&lt;packname&gt;/name名称的文件夹</code>目录(没有就会先创建)</td>
</tr>
<tr>
<td>String[] fileList()</td>
<td>获取<code>data/data/&lt;packname&gt;/files</code>目录下的所有文件名称列表.</td>
</tr>
<tr>
<td>File getCacheDir()</td>
<td>获取<code>data/data/&lt;packname&gt;/cache</code>目录</td>
</tr>
</tbody>
</table>
<h2 id="系统的多选模式"><a href="#系统的多选模式" class="headerlink" title="系统的多选模式"></a>系统的多选模式</h2><p>如下效果:</p>
<p><img src="http://szysky.com/2016/09/07/%E3%80%8AAndroid%E7%BC%96%E7%A8%8B%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B%E9%9A%8F%E8%AE%B0%E4%B8%80/multidex.gif" alt="img"></p>
<p>开始实现步骤:</p>
<p><strong>1. 首先定义多选菜单的资源文件</strong></p>
<p>例如上面的垃圾桶图标需要手动去设置, 在<code>res/menu/</code>目录下创建一个xml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;menu xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;</div><div class="line">    &lt;item</div><div class="line">        android:id=&quot;@+id/menu_item_delete_crime&quot;</div><div class="line">        android:icon=&quot;@android:drawable/ic_menu_delete&quot;</div><div class="line">        android:title=&quot;@string/delete_crime&quot;/&gt;</div><div class="line">&lt;/menu&gt;</div></pre></td></tr></table></figure>
<p>同样使用系统的资源图片, 就是右上角的垃圾桶.</p>
<p><strong>2. 实现Content菜单(进入编辑模式)</strong></p>
<p><strong>这里面有两种,在旧版本11之前上编辑模式是单项操作模式, 后续版本是多选模式, 下面简单说一下旧版本的模式然后在回到上面图中的多选模式, 可以直接跳过直接看多选模式, 毕竟11版本已经很旧了</strong></p>
<p>于之前的<code>操作栏里面的步骤大致相同</code>. 这里复写的方法是有两个(fragment类中)</p>
<ul>
<li><code>onCreateContextMenu(...)</code>: 实例化一个Content多选菜单</li>
<li><code>onContextItemSelected(...)</code>: 响应菜单选择按钮</li>
</ul>
<p>这里还是以在<code>fragment</code>中的代码举例.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">@Override</div><div class="line">public void onCreateContextMenu(ContextMenu menu, View v, ContextMenu.ContextMenuInfo menuInfo) &#123;</div><div class="line">   // 为操作栏创建浮动的上下文菜单</div><div class="line">   mActivity.getMenuInflater().inflate(R.menu.crime_list_item_context, menu);</div><div class="line">&#125;</div><div class="line">    </div><div class="line">   // 浮动上下文的点击监听回调</div><div class="line">@Override</div><div class="line">public boolean onContextItemSelected(MenuItem item) &#123;</div><div class="line">   switch (item.getItemId())&#123;</div><div class="line">       //  显示删除的浮动上下文</div><div class="line">       case R.id.menu_item_delete_crime:</div><div class="line">           // 获得点击的具体listview的item位置, 并得到对象</div><div class="line">           AdapterView.AdapterContextMenuInfo menuInfo = (AdapterView.AdapterContextMenuInfo) item.getMenuInfo();</div><div class="line">           // 获得点击的item信息得到posion</div><div class="line">           int position = menuInfo.position;</div><div class="line">           CrimeBean clickItemBean = ((MyCrimeAdapter) getListAdapter()).getItem(position);</div><div class="line"></div><div class="line">           //</div><div class="line">           mCrimes.remove(clickItemBean);</div><div class="line">           ((MyCrimeAdapter) getListAdapter()).notifyDataSetChanged();</div><div class="line">           return true;</div><div class="line">       default:</div><div class="line">           return super.onContextItemSelected(item);</div><div class="line"></div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>最后一步为<code>ContextMenu</code>登记一个<code>ListView</code>如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">// 在低版本使用浮动上下文菜单</div><div class="line">registerForContextMenu(lv_main);</div></pre></td></tr></table></figure>
<hr>
<p><strong>回到多选模式, 还是多选好</strong></p>
<p>接着第二大步开始. 如果要想实现多选模式的<code>ContextMenu</code>. 那么需要设置列表视图的选择模式为<code>ListView.CHOICE_MODE_MULTIPLE_MODAL</code>, 然后并添加个监听响应即可,其实很简单.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">lv_main.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE_MODAL);</div><div class="line">//  设置列表视图操作模式回调</div><div class="line">lv_main.setMultiChoiceModeListener(new AbsListView.MultiChoiceModeListener() &#123;</div><div class="line">    // 视图中的选项在选中或者撤销的时候会触发</div><div class="line">    @Override</div><div class="line">    public void onItemCheckedStateChanged(ActionMode mode, int position, long id, boolean checked) &#123;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    // 在ActionMode对象创建后调用, 也是实例化上下文菜单资源, 并显示在上下文操作栏上的任务完成的地方        </div><div class="line">    @Override</div><div class="line">    public boolean onCreateActionMode(ActionMode mode, Menu menu) &#123;</div><div class="line">    MenuInflater menuInflater = mode.getMenuInflater();</div><div class="line">    menuInflater.inflate(R.menu.crime_list_item_context, menu);</div><div class="line">    return true;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    // 在onCreateActionMode()回调之后调用, 以及当前上下文操作栏需要刷新显示新数据时调用</div><div class="line">    @Override</div><div class="line">    public boolean onPrepareActionMode(ActionMode mode, Menu menu) &#123;</div><div class="line">    return false;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // 在用户选中某个菜单项操作时调用(这里就是垃圾桶图标按钮). 是相应上下文菜单项操作的地方</div><div class="line">    @Override</div><div class="line">    public boolean onActionItemClicked(ActionMode mode, MenuItem item) &#123;</div><div class="line">    switch (item.getItemId())&#123;</div><div class="line">        case R.id.menu_item_delete_crime:</div><div class="line">            for (int i = myCrimeAdapter.getCount()-1; i &gt;= 0; i--) &#123;</div><div class="line">                if (getListView().isItemChecked(i))&#123;</div><div class="line">                    mCrimes.remove(myCrimeAdapter.getItem(i));</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            mode.finish();</div><div class="line">            myCrimeAdapter.notifyDataSetChanged();</div><div class="line">            return true;</div><div class="line">    &#125;</div><div class="line">    return false;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // 在用户退出上下文操作模式或所选菜单项操作已被响应, 从而导致ActionMode对象将要销毁时调用.</div><div class="line">    // 默认的实现会导致已选视图被反选, 也可以完成上下文操作模式下, 响应菜单项操作而引起的响应fragment刷新</div><div class="line">    @Override</div><div class="line">    public void onDestroyActionMode(ActionMode mode) &#123;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><strong>3. 最后一步</strong></p>
<p>这个最后一步是针对<strong>多选模式下的</strong>, 上面两步已经在逻辑功能上完成了之前的需求, 但是有一点, 当进入多选的时候点击或不点击发现没有区别, 我们无法得知哪一个<strong>item</strong>是否已经被点击激活状态, 哪一个没有没点击激活. <strong>所有我们需要给Item添加一个背景, 设置一下item的激活或者非激活的背景色</strong>, 代码如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">// 在drawable/文件夹下创建一个文件</div><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;selector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;</div><div class="line">    &lt;!--当引用控件处于激活状态时, 则使用指定的资源文件, 反之不采取任何操作--&gt;</div><div class="line">    &lt;item android:state_activated=&quot;true&quot;</div><div class="line">        android:drawable=&quot;@android:color/darker_gray&quot;/&gt;</div><div class="line">&lt;/selector&gt;</div></pre></td></tr></table></figure>
<p>把这个<code>StateListDrawable</code>状态<code>drawable</code>设置到<code>ListView的item背景属性上</code>.</p>
<p>ok 关于多选的<code>ContentMenu</code>操作就实现完成.</p>
<p><strong>扩展一下:</strong></p>
<p>这里实现的方法可以完全作用在<code>ListView</code>和<code>GridView</code>中(GridView和ListView都是AdapterView的子类). 但是如果不是这两个类型的控件应该如何实现这种多选方式.</p>
<ol>
<li>首先给一个控件实现<strong>长按监听</strong></li>
<li>在长按回调中调用<code>Activity.startActivityMode(..)</code>并创建一个<code>ActionMode.Callback</code>的接口作为参数传入. 这个接口里面的回调很熟悉就是上面<code>ListView</code>设置了<code>setMultiChoiceModeListener</code>里面创建的匿名类里面对应的回调.</li>
</ol>
<h2 id="设备屏幕尺寸的确定"><a href="#设备屏幕尺寸的确定" class="headerlink" title="设备屏幕尺寸的确定"></a>设备屏幕尺寸的确定</h2><p>你可能会发现你的项目目录中存在如下这个文件, 但具体什么意思却不是很清楚</p>
<p><img src="http://szysky.com/2016/09/07/%E3%80%8AAndroid%E7%BC%96%E7%A8%8B%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E3%80%8B%E9%9A%8F%E8%AE%B0%E4%B8%80/screen_1.png" alt="img"></p>
<p>这是在<code>Android 3.2之后引入的新修饰符</code>, 在3.2之前是使用<code>small, normal, large, xlarge</code>来讲设备分为不同的屏幕大小类别.</p>
<p>现在新引入的屏幕尺寸修饰符如下表:</p>
<table>
<thead>
<tr>
<th>修饰符格式</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>wXXXdp</td>
<td>有效宽度: 宽度大于或等于 XXX dp</td>
</tr>
<tr>
<td>hXXXdp</td>
<td>有效高度: 高度大于或等于 XXX dp</td>
</tr>
<tr>
<td>swXXXdp</td>
<td>最小宽度: 宽度或者高度(两者中最小的那个) 大于或等于 xxx dp</td>
</tr>
</tbody>
</table>
<p>如果要指定某一个布局仅适用于屏幕宽度至少<strong>300dp</strong>的设备, 这种情况下, 可以使用宽度修饰符, 并将布局文件放入<code>res/layout-w300dp</code>目录下, (w代表宽度width). 同样道理如果是高度那么使用<code>hxxxdp</code></p>
<p>有时候设备方向变换, 也会导致设备的宽高发生变化. 为了确定某个具体的屏幕尺寸可是使用<code>sw</code>, 如果不管是横屏<code>1280*720</code>还是竖屏的<code>720*1280</code>, 其对应的sw的值都是800.</p>
<h2 id="以命令行的方式运行activity"><a href="#以命令行的方式运行activity" class="headerlink" title="以命令行的方式运行activity"></a>以命令行的方式运行activity</h2><p>要用<code>adb</code>命令启动首先需要满足<code>activity</code>组件可以被外部启动. 需要在清单文件中配置要被启动的<code>activity</code>的属性如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;activity android:name=&quot;.activity.CrimeCameraActivity&quot;</div><div class="line">            android:exported=&quot;true&quot;/&gt;</div></pre></td></tr></table></figure>
<p>设置<code>exported</code>属性. 这个属性默认是<strong>false</strong>. 表示只能从自己的应用中启动. <strong>如果将intent过滤器添加到activity的声明中, 那么该activity的exported将被自动设置为true</strong></p>
<p>然后使用<code>adb</code>命令, 如果你没有设置全局环境那么就到<code>Android SDK</code>安装目录<code>platform-tools</code>子目录下执行adb命令.</p>
<p><code>adb shell am start -n 应用包名/.activity类名</code></p>
<p>/ 后面接的和清单文件中<code>activity</code>的name属性对应的是一样的. 如果你如上代码在多层包中. 那么实际上是这样的. 我的包名<code>com.szysky.note.criminal</code></p>
<p>演示代码:</p>
<p><code>adb shell am start -n com.szysky.note.criminal/.activity.CrimeCameraActivity</code></p>
<p><code>am(Activity Manager)</code>是一个在设备上运行的命令行程序. 它支持启动和停止Android组件(component)并从命令行发送intent. 可以运行adb shell am指令. 查看am工具能够完成的所有任务.</p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://yoursite.com/2017/09/07/android/books/《Android编程权威指南》Chap1_ 零散整理/" data-id="cj7aafudx00025fpjnct5hz1n" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    
        <a href="http://yoursite.com/2017/09/07/android/books/《Android编程权威指南》Chap1_ 零散整理/#comments" class="article-comment-link">Comments</a>
    

        </footer>
    </div>
    
</article>



    <nav id="page-nav">
        <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
</section>
            
                
<aside id="sidebar">
   
        
    <div class="widget-wrap">
        <h3 class="widget-title">recent</h3>
        <div class="widget">
            <ul id="recent-post" class="no-thumbnail">
                
                    <li>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/android/">android</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/android/《Android-编程实战》/">《Android 编程实战》</a></p>
                            <p class="item-title"><a href="/2017/09/11/android/books/《Android 编程实战》Chap4_手势操作进阶, 重识Service/" class="title">《Android 编程实战》Chap4_手势操作进阶, 重识Service</a></p>
                            <p class="item-date"><time datetime="2017-09-11T13:36:48.000Z" itemprop="datePublished">2017-09-11</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/android/">android</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/android/《Android-编程实战》/">《Android 编程实战》</a></p>
                            <p class="item-title"><a href="/2017/09/11/android/books/《Android 编程实战》Chap3_组件 清单 资源和UI闲聊/" class="title">《Android 编程实战》Chap3_组件 清单 资源和UI闲聊</a></p>
                            <p class="item-date"><time datetime="2017-09-11T13:36:06.000Z" itemprop="datePublished">2017-09-11</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/android/">android</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/android/《Android-编程实战》/">《Android 编程实战》</a></p>
                            <p class="item-title"><a href="/2017/09/11/android/books/《Android 编程实战》Chap2_Android上编写高效Java/" class="title">《Android 编程实战》Chap2_Android上编写高效Java</a></p>
                            <p class="item-date"><time datetime="2017-09-11T13:35:09.000Z" itemprop="datePublished">2017-09-11</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/android/">android</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/android/《Android-编程实战》/">《Android 编程实战》</a></p>
                            <p class="item-title"><a href="/2017/09/11/android/books/《Android 编程实战》Chap1_完善开发环境和优化/" class="title">《Android 编程实战》Chap1_完善开发环境和优化</a></p>
                            <p class="item-date"><time datetime="2017-09-11T13:34:19.000Z" itemprop="datePublished">2017-09-11</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/mysql/">mysql</a></p>
                            <p class="item-title"><a href="/2017/09/08/mysql/mysql_4 数据控制语言控制/" class="title">mysql_4 数据控制语言控制</a></p>
                            <p class="item-date"><time datetime="2017-09-08T09:10:54.000Z" itemprop="datePublished">2017-09-08</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">categories</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/android/">android</a><span class="category-list-count">29</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/android/code/">code</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/android/github/">github</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/android/《Android-编程实战》/">《Android 编程实战》</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/android/《Android开发艺术探索》/">《Android开发艺术探索》</a><span class="category-list-count">15</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/android/《Android编程权威指南》/">《Android编程权威指南》</a><span class="category-list-count">4</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/learn/">learn</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/learn/《如何高效学习》/">《如何高效学习》</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/linux/vim/">vim</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/markdown/">markdown</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mysql/">mysql</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/node/">node</a><span class="category-list-count">7</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/node/7days/">7days</a><span class="category-list-count">7</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><span class="category-list-count">1</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">archives</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a><span class="archive-list-count">31</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a><span class="archive-list-count">7</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">tags</h3>
        <div class="widget">
            <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/analysis/">analysis</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android/">android</a><span class="tag-list-count">28</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/anslysis/">anslysis</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/autoLink/">autoLink</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/code/">code</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/">github</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/indicator/">indicator</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/learn/">learn</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/markdown/">markdown</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node/">node</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/textview/">textview</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vim/">vim</a><span class="tag-list-count">1</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">tag cloud</h3>
        <div class="widget tagcloud">
            <a href="/tags/analysis/" style="font-size: 10px;">analysis</a> <a href="/tags/android/" style="font-size: 20px;">android</a> <a href="/tags/anslysis/" style="font-size: 10px;">anslysis</a> <a href="/tags/autoLink/" style="font-size: 10px;">autoLink</a> <a href="/tags/code/" style="font-size: 14px;">code</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/github/" style="font-size: 12px;">github</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/indicator/" style="font-size: 10px;">indicator</a> <a href="/tags/learn/" style="font-size: 10px;">learn</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/mysql/" style="font-size: 16px;">mysql</a> <a href="/tags/node/" style="font-size: 18px;">node</a> <a href="/tags/textview/" style="font-size: 10px;">textview</a> <a href="/tags/vim/" style="font-size: 10px;">vim</a>
        </div>
    </div>

    
        
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">links</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="http://hexo.io">Hexo</a>
                    </li>
                
            </ul>
        </div>
    </div>


    
    <div id="toTop" class="fa fa-angle-up"></div>
</aside>

            
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2017 Ernest Chang<br>
            Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
        </div>
    </div>
</footer>
        
    
    <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2142274"></script>




    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>